
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../sync/">
      
      
        <link rel="next" href="../../developer_docs/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Utils - DJ Tools</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DJ Tools" class="md-header__button md-logo" aria-label="DJ Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DJ Tools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Utils
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/a-rich/DJ-Tools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DJ Tools" class="md-nav__button md-logo" aria-label="DJ Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DJ Tools
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/a-rich/DJ-Tools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-to Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-to Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Collection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Collection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/collection_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build Playlists From Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/combiner_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Combine Playlists With Boolean Algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/copy_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copy Tracks From Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/shuffle_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shuffle Tracks in Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Spotify
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Spotify
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/reddit_spotify_api_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup Reddit & Spotify API Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/spotify_playlist_from_upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Spotify Playlists From Other Users' Uploads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/spotify_playlist_from_reddit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Spotify Playlists From Reddit Posts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Sync
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/setup_object_storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup Object Storage For Syncing Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/sync_beatcloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Files with the Beatcloud
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/sync_spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Tracks From Spotify Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/check_beatcloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check the Beatcloud for Tracks in Spotify Playlists or Local Directories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/extract_from_url/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extract Audio Files From URLs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/process_recordings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Process Recorded Files Using Spotify Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/standardize_audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standardize Audio Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conceptual Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Conceptual Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/rekordbox_collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get to Know Your Rekordbox Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/tagging_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tagging Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/file_standardization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Importance of Standardization and Quality Control
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spotify
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig" class="md-nav__link">
    <span class="md-ellipsis">
      UtilsConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UtilsConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.bitrate_validation" class="md-nav__link">
    <span class="md-ellipsis">
      bitrate_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.format_validation" class="md-nav__link">
    <span class="md-ellipsis">
      format_validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.check_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      check_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.check_tracks.compare_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      compare_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.normalize_audio" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.normalize_audio.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      normalize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.process_recording" class="md-nav__link">
    <span class="md-ellipsis">
      process_recording
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.process_recording.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download" class="md-nav__link">
    <span class="md-ellipsis">
      url_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download.fix_up" class="md-nav__link">
    <span class="md-ellipsis">
      fix_up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download.url_download" class="md-nav__link">
    <span class="md-ellipsis">
      url_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers" class="md-nav__link">
    <span class="md-ellipsis">
      helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.compute_distance" class="md-nav__link">
    <span class="md-ellipsis">
      compute_distance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.find_matches" class="md-nav__link">
    <span class="md-ellipsis">
      find_matches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_beatcloud_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_beatcloud_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_local_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_local_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_playlist_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_playlist_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_spotify_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_spotify_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.initialize_logger" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.make_path" class="md-nav__link">
    <span class="md-ellipsis">
      make_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.process_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      process_parallel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.reverse_title_and_artist" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_title_and_artist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.trim_initial_silence" class="md-nav__link">
    <span class="md-ellipsis">
      trim_initial_silence
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developer Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/system_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/new_collections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding DJ Software Support to the Collections Package
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/collections_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using the Collections API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/playlist_filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding Custom PlaylistFilters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig" class="md-nav__link">
    <span class="md-ellipsis">
      UtilsConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UtilsConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.bitrate_validation" class="md-nav__link">
    <span class="md-ellipsis">
      bitrate_validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.utils.config.UtilsConfig.format_validation" class="md-nav__link">
    <span class="md-ellipsis">
      format_validation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.check_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      check_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.check_tracks.compare_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      compare_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.normalize_audio" class="md-nav__link">
    <span class="md-ellipsis">
      normalize_audio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.normalize_audio.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      normalize
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.process_recording" class="md-nav__link">
    <span class="md-ellipsis">
      process_recording
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.process_recording.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download" class="md-nav__link">
    <span class="md-ellipsis">
      url_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download.fix_up" class="md-nav__link">
    <span class="md-ellipsis">
      fix_up
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.url_download.url_download" class="md-nav__link">
    <span class="md-ellipsis">
      url_download
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers" class="md-nav__link">
    <span class="md-ellipsis">
      helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.compute_distance" class="md-nav__link">
    <span class="md-ellipsis">
      compute_distance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.find_matches" class="md-nav__link">
    <span class="md-ellipsis">
      find_matches
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_beatcloud_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_beatcloud_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_local_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_local_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_playlist_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_playlist_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.get_spotify_tracks" class="md-nav__link">
    <span class="md-ellipsis">
      get_spotify_tracks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.initialize_logger" class="md-nav__link">
    <span class="md-ellipsis">
      initialize_logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.make_path" class="md-nav__link">
    <span class="md-ellipsis">
      make_path
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.process_parallel" class="md-nav__link">
    <span class="md-ellipsis">
      process_parallel
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.reverse_title_and_artist" class="md-nav__link">
    <span class="md-ellipsis">
      reverse_title_and_artist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.utils.helpers.trim_initial_silence" class="md-nav__link">
    <span class="md-ellipsis">
      trim_initial_silence
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="utils">Utils</h1>


<div class="doc doc-object doc-module">



<a id="djtools.utils.config"></a>
    <div class="doc doc-contents first">

        <p>This module contains the configuration object for the utils package. The
attributes of this configuration object correspond with the "utils" key of
config.yaml</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="djtools.utils.config.UtilsConfig" class="doc doc-heading">
            <code>UtilsConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="djtools.configs.config_formatter.BaseConfigFormatter">BaseConfigFormatter</span></code></p>


        <p>Configuration object for the utils package.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/utils/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UtilsConfig</span><span class="p">(</span><span class="n">BaseConfigFormatter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration object for the utils package.&quot;&quot;&quot;</span>

    <span class="n">audio_bitrate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;320&quot;</span>
    <span class="n">audio_destination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">audio_format</span><span class="p">:</span> <span class="n">AudioFormats</span> <span class="o">=</span> <span class="n">AudioFormats</span><span class="o">.</span><span class="n">MP3</span>
    <span class="n">audio_headroom</span><span class="p">:</span> <span class="n">NonNegativeFloat</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">check_tracks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">check_tracks_fuzz_ratio</span><span class="p">:</span> <span class="n">NonNegativeInt</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="n">check_tracks_spotify_playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">local_dirs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">normalize_audio</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">process_recording</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">recording_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">recording_playlist</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">trim_initial_silence</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TrimInitialSilenceMode</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">url_download</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: aws_profile must be set for check_tracks.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_tracks</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_PROFILE&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Without aws_profile set to a valid profile (&#39;default&#39; or &quot;</span>
                    <span class="s2">&quot;otherwise) you cannot use the check_tracks feature&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_tracks_spotify_playlists</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;check_tracks depends on valid Spotify API credentials in &quot;</span>
                    <span class="s2">&quot;SpotifyConfig.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_recording</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recording_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Could not find recording_file &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">recording_file</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recording_playlist</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;You must provide a playlist name as recording_playlist &quot;</span>
                    <span class="s2">&quot;and this name must exists in spotify_playlists.yaml.&quot;</span>
                <span class="p">)</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;audio_bitrate&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bitrate_validation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates audio_bitrate is in the range and casts it to a string.</span>

<span class="sd">        Args:</span>
<span class="sd">            value: audio_bitrate field</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: audio_bitrate must be in the range [36, 320]</span>

<span class="sd">        Returns:</span>
<span class="sd">            String representing the bit rate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">36</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">320</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;audio_bitrate must be in the range [36, 320]&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_validation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;UtilsConfig&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;UtilsConfig&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logs a warning message to install FFmpeg if audio_format isn&#39;t wav.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The validated model instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The validated model instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">audio_format</span> <span class="o">!=</span> <span class="s2">&quot;wav&quot;</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="n">normalize_audio</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">process_recording</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;You must install FFmpeg in order to use non-wav file formats.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.utils.config.UtilsConfig.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>aws_profile must be set for check_tracks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: aws_profile must be set for check_tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_tracks</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AWS_PROFILE&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Without aws_profile set to a valid profile (&#39;default&#39; or &quot;</span>
                <span class="s2">&quot;otherwise) you cannot use the check_tracks feature&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_tracks_spotify_playlists</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;check_tracks depends on valid Spotify API credentials in &quot;</span>
                <span class="s2">&quot;SpotifyConfig.&quot;</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_recording</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recording_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Could not find recording_file &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">recording_file</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">recording_playlist</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;You must provide a playlist name as recording_playlist &quot;</span>
                <span class="s2">&quot;and this name must exists in spotify_playlists.yaml.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.utils.config.UtilsConfig.bitrate_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bitrate_validation</span><span class="p">(</span><span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Validates audio_bitrate is in the range and casts it to a string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>audio_bitrate field</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>audio_bitrate must be in the range [36, 320]</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representing the bit rate.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;audio_bitrate&quot;</span><span class="p">)</span>
<span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">bitrate_validation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates audio_bitrate is in the range and casts it to a string.</span>

<span class="sd">    Args:</span>
<span class="sd">        value: audio_bitrate field</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: audio_bitrate must be in the range [36, 320]</span>

<span class="sd">    Returns:</span>
<span class="sd">        String representing the bit rate.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">36</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">320</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;audio_bitrate must be in the range [36, 320]&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.utils.config.UtilsConfig.format_validation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_validation</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Logs a warning message to install FFmpeg if audio_format isn't wav.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="UtilsConfig (djtools.utils.config.UtilsConfig)" href="#djtools.utils.config.UtilsConfig">UtilsConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated model instance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="UtilsConfig (djtools.utils.config.UtilsConfig)" href="#djtools.utils.config.UtilsConfig">UtilsConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated model instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">format_validation</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s2">&quot;UtilsConfig&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;UtilsConfig&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Logs a warning message to install FFmpeg if audio_format isn&#39;t wav.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The validated model instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The validated model instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">audio_format</span> <span class="o">!=</span> <span class="s2">&quot;wav&quot;</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">normalize_audio</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">process_recording</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You must install FFmpeg in order to use non-wav file formats.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.utils.check_tracks"></a>
    <div class="doc doc-contents first">

        <p>This module is used to compare tracks from Spotify playlists and / or local
directories to see if there is any overlap with the contents of the Beatcloud.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.utils.check_tracks.compare_tracks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">beatcloud_tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Compares tracks from Spotify / local with Beatcloud tracks.</p>
<p>Gets track titles and artists from Spotify playlist(s) and / or file names
from local directories, and get file names from the beatcloud. Then compute
the Levenshtein similarity between their product in order to identify any
overlapping tracks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.check_tracks.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beatcloud_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cached list of tracks from S3.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.List">List</span>[<span title="str">str</span>], <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple with a list of all Beatcloud tracks and list of full paths to
matching Beatcloud tracks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/check_tracks.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compare_tracks</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span>
    <span class="n">beatcloud_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compares tracks from Spotify / local with Beatcloud tracks.</span>

<span class="sd">    Gets track titles and artists from Spotify playlist(s) and / or file names</span>
<span class="sd">    from local directories, and get file names from the beatcloud. Then compute</span>
<span class="sd">    the Levenshtein similarity between their product in order to identify any</span>
<span class="sd">    overlapping tracks.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        beatcloud_tracks: Cached list of tracks from S3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple with a list of all Beatcloud tracks and list of full paths to</span>
<span class="sd">            matching Beatcloud tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">download_spotify_playlist</span><span class="p">:</span>
        <span class="n">cached_local_dirs</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">local_dirs</span>
        <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">local_dirs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">spotify_playlists</span> <span class="o">=</span> <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">download_spotify_playlist</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">spotify_playlists</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">check_tracks_spotify_playlists</span>

    <span class="n">track_sets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">beatcloud_matches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">spotify_playlists</span><span class="p">:</span>
        <span class="n">spotify_tracks</span> <span class="o">=</span> <span class="n">get_spotify_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">spotify_playlists</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spotify_tracks</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">download_spotify_playlist</span><span class="p">:</span>
                <span class="n">substring</span> <span class="o">=</span> <span class="s2">&quot;download_spotify_playlist is a key&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">substring</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;check_tracks_spotify_playlists has one or more keys&quot;</span>
                <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There are no Spotify tracks; make sure </span><span class="si">{</span><span class="n">substring</span><span class="si">}</span><span class="s2"> in &quot;</span>
                <span class="s2">&quot;spotify_playlists.yaml&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">track_results</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">playlist_name</span><span class="p">,</span> <span class="n">playlist_tracks</span> <span class="ow">in</span> <span class="n">spotify_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">playlist_tracks</span><span class="p">:</span>
                    <span class="n">title</span> <span class="o">=</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="n">artists</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;artists&quot;</span><span class="p">]]</span>
                    <span class="p">)</span>
                    <span class="n">track_results</span><span class="p">[</span><span class="n">playlist_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">artists</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">artist_first</span>
                        <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">artists</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
            <span class="n">track_sets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">track_results</span><span class="p">,</span> <span class="s2">&quot;Spotify Playlist Tracks&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">local_dirs</span><span class="p">:</span>
        <span class="n">local_tracks</span> <span class="o">=</span> <span class="n">get_local_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">local_tracks</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;There are no local tracks; make sure local_dirs has one or &quot;</span>
                <span class="s2">&quot;more directories containing one or more tracks&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">track_results</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="n">track</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">local_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">track_sets</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">track_results</span><span class="p">,</span> <span class="s2">&quot;Local Directory Tracks&quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">download_spotify_playlist</span><span class="p">:</span>
        <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">local_dirs</span> <span class="o">=</span> <span class="n">cached_local_dirs</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">track_sets</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">beatcloud_tracks</span><span class="p">,</span> <span class="n">beatcloud_matches</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">beatcloud_tracks</span><span class="p">:</span>
        <span class="n">beatcloud_tracks</span> <span class="o">=</span> <span class="n">get_beatcloud_tracks</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">bucket_url</span><span class="p">)</span>

    <span class="n">path_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="o">.</span><span class="n">stem</span><span class="p">:</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">beatcloud_tracks</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">tracks</span><span class="p">,</span> <span class="n">track_type</span> <span class="ow">in</span> <span class="n">track_sets</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">artist_first</span> <span class="ow">and</span> <span class="n">track_type</span> <span class="o">==</span> <span class="s2">&quot;Local Directory Tracks&quot;</span><span class="p">:</span>
            <span class="n">path_lookup</span> <span class="o">=</span> <span class="n">reverse_title_and_artist</span><span class="p">(</span><span class="n">path_lookup</span><span class="p">)</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">find_matches</span><span class="p">(</span>
            <span class="n">tracks</span><span class="p">,</span>
            <span class="n">path_lookup</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">config</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">track_type</span><span class="si">}</span><span class="s2"> / Beatcloud Matches: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">loc</span><span class="p">,</span> <span class="n">matches</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loc</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">track</span><span class="p">,</span> <span class="n">beatcloud_track</span><span class="p">,</span> <span class="n">fuzz_ratio</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">beatcloud_matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path_lookup</span><span class="p">[</span><span class="n">beatcloud_track</span><span class="p">])</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">fuzz_ratio</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">track</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">beatcloud_track</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">beatcloud_tracks</span><span class="p">,</span> <span class="n">beatcloud_matches</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.utils.normalize_audio"></a>
    <div class="doc doc-contents first">

        <p>This module is used to normalize audio files in one or more directories.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.utils.normalize_audio.normalize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">normalize</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Gets local tracks and normalizes them.</p>
<p>Tracks will be overwritten and have a headroom equal to audio_headroom.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.normalize_audio.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Must have local tracks to normalize.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/normalize_audio.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets local tracks and normalizes them.</span>

<span class="sd">    Tracks will be overwritten and have a headroom equal to audio_headroom.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: Must have local tracks to normalize.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">folder_tracks</span> <span class="o">=</span> <span class="n">get_local_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">folder_tracks</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;There are no local tracks; make sure local_dirs has one or &quot;</span>
            <span class="s2">&quot;more directories containing one or more tracks&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="n">track</span>
        <span class="k">for</span> <span class="n">tracks</span> <span class="ow">in</span> <span class="n">folder_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">track</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">audio</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Couldn&#39;t decode </span><span class="si">{</span><span class="n">track</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">max_dBFS</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_headroom</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">track</span><span class="si">}</span><span class="s2"> has a max dB of </span><span class="si">{</span><span class="n">audio</span><span class="o">.</span><span class="n">max_dBFS</span><span class="si">}</span><span class="s2">, normalizing to &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;have a headroom of </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_headroom</span><span class="si">}</span><span class="s2">...&quot;</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tags</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">mediainfo</span><span class="p">(</span><span class="n">track</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TAG&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t export </span><span class="si">{</span><span class="n">track</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2"> with ID3 tags; ensure &quot;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;ffmpeg&quot; is installed: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span>
                <span class="n">tags</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">audio</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span>
                <span class="n">audio</span><span class="p">,</span> <span class="n">headroom</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_headroom</span>
            <span class="p">)</span>
            <span class="n">audio</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
                <span class="n">track</span><span class="o">.</span><span class="n">parent</span>
                <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">track</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_format</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
                <span class="n">bitrate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_bitrate</span><span class="si">}</span><span class="s2">k&quot;</span><span class="p">,</span>
                <span class="nb">format</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_format</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.utils.process_recording"></a>
    <div class="doc doc-contents first">

        <p>This module is used to process an audio recording.</p>
<p>Given a recording of multiple tracks and a Spotify playlist, use the
information from the Spotify API to:</p>
<ul>
<li>split the recording into individual files</li>
<li>name these files with the title and artist(s)</li>
<li>populate the title, artist, and album tags</li>
<li>normalize the audio so the headroom is audio_headroom decibels</li>
<li>export the files with the configured audio_bitrate and audio_format</li>
</ul>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.utils.process_recording.process" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Process a recording whose contents map to tracks in a Spotify playlist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.process_recording.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configured recording_playlist must both exist
in spotify_playlists.yaml and have tracks in it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/process_recording.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a recording whose contents map to tracks in a Spotify playlist.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: The configured recording_playlist must both exist</span>
<span class="sd">            in spotify_playlists.yaml and have tracks in it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the tracks of the target Spotify playlist.</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="n">get_spotify_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">recording_playlist</span><span class="p">])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tracks</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;There are no Spotify tracks; make sure download_spotify_playlist &quot;</span>
            <span class="s2">&quot;is a key from spotify_playlists.yaml&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Parse the relevant data from the track responses.</span>
    <span class="n">track_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">playlist_duration</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">recording_playlist</span><span class="p">]:</span>
        <span class="c1"># Parse release date field based on the date precision</span>
        <span class="n">date_year</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">release_date</span> <span class="o">=</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;album&quot;</span><span class="p">][</span><span class="s2">&quot;release_date&quot;</span><span class="p">]</span>
        <span class="n">release_precision</span> <span class="o">=</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;album&quot;</span><span class="p">][</span><span class="s2">&quot;release_date_precision&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">release_precision</span> <span class="o">==</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span>
            <span class="n">date_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">release_date</span><span class="p">,</span> <span class="s2">&quot;%Y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
        <span class="k">elif</span> <span class="n">release_precision</span> <span class="o">==</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span>
            <span class="n">date_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">release_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>
        <span class="k">elif</span> <span class="n">release_precision</span> <span class="o">==</span> <span class="s2">&quot;day&quot;</span><span class="p">:</span>
            <span class="n">date_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">release_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">year</span>

        <span class="c1"># TODO(a-rich): Why won&#39;t Rekordbox load &quot;label&quot; and &quot;year&quot; tags?!</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;album&quot;</span><span class="p">:</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;album&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;artist&quot;</span><span class="p">:</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;artists&quot;</span><span class="p">]]</span>
            <span class="p">),</span>
            <span class="c1"># NOTE: There&#39;s a 500 ms gap between tracks during playback that</span>
            <span class="c1"># must be accounted for.</span>
            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;duration_ms&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">500</span><span class="p">,</span>
            <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;album&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
            <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">date_year</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">track_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">playlist_duration</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span>

    <span class="c1"># Load the audio and trim the initial silence.</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading audio...&quot;</span><span class="p">)</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">recording_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">trim_initial_silence</span><span class="p">:</span>
        <span class="n">audio</span> <span class="o">=</span> <span class="n">trim_initial_silence</span><span class="p">(</span>
            <span class="n">audio</span><span class="p">,</span>
            <span class="p">[</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_data</span><span class="p">],</span>
            <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">trim_initial_silence</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Check that the audio is at least as long as the playlist duration.</span>
    <span class="n">audio_duration</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">audio_duration</span> <span class="o">&lt;</span> <span class="n">playlist_duration</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">recording_file</span><span class="si">}</span><span class="s2"> has a duration of </span><span class="si">{</span><span class="n">audio_duration</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="s2">&quot;milliseconds which is less than the sum of track lengths in the &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Spotify playlist </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">recording_playlist</span><span class="si">}</span><span class="s2"> which is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_duration</span><span class="si">}</span><span class="s2"> milliseconds. Please confirm your recording &quot;</span>
            <span class="s2">&quot;went as expected!&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Create destination for exported audio.</span>
    <span class="n">write_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_destination</span>
    <span class="n">write_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Split recording into the individual tracks.</span>
    <span class="n">audio_chunks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_data</span><span class="p">:</span>
        <span class="n">track_audio</span> <span class="o">=</span> <span class="n">audio</span><span class="p">[:</span> <span class="n">track</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]]</span>
        <span class="n">audio</span> <span class="o">=</span> <span class="n">audio</span><span class="p">[</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="p">:]</span>
        <span class="n">audio_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track_audio</span><span class="p">)</span>

    <span class="c1"># Normalize audio and export tracks with tags.</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="n">config</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_chunks</span><span class="p">),</span>
        <span class="n">audio_chunks</span><span class="p">,</span>
        <span class="n">track_data</span><span class="p">,</span>
        <span class="p">[</span><span class="n">write_path</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">audio_chunks</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">exported_files</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
        <span class="n">max_workers</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># pylint: disable=no-member</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">exported_files</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">args</span><span class="p">:</span> <span class="n">process_parallel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">),</span> <span class="n">payload</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exported_files</span><span class="p">):</span>
        <span class="n">creation_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">()</span> <span class="o">+</span> <span class="n">index</span>
        <span class="n">os</span><span class="o">.</span><span class="n">utime</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="p">(</span><span class="n">creation_time</span><span class="p">,</span> <span class="n">creation_time</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.utils.url_download"></a>
    <div class="doc doc-contents first">

        <p>This module is used to download tracks from "url_download". For example, a
Soundcloud playlist can be made and the URL of that playlist can be provided to
download all those tracks and rename them to cleanup the digits appended to the
files by the youtube-dl package.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.utils.url_download.fix_up" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fix_up</span><span class="p">(</span><span class="n">_file</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Removes digits appended to file name by youtube-dl.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>_file</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Music file name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Cleaned up music file name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/url_download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fix_up</span><span class="p">(</span><span class="n">_file</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes digits appended to file name by youtube-dl.</span>

<span class="sd">    Args:</span>
<span class="sd">        _file: Music file name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Cleaned up music file name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ext</span> <span class="o">=</span> <span class="n">_file</span><span class="o">.</span><span class="n">suffix</span>
    <span class="n">exp</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;(\-\d</span><span class="se">{{</span><span class="s2">1,</span><span class="se">}}</span><span class="s2">(?=</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">))&quot;</span>
    <span class="n">stripped</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">stem</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stripped</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.url_download.url_download" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">url_download</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Downloads music files from a provided URL using the youtube-dl package.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.url_download.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/url_download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">url_download</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads music files from a provided URL using the youtube-dl package.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dl_loc</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_destination</span> <span class="ow">or</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">dl_loc</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ydl_opts</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;postprocessors&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;FFmpegExtractAudio&quot;</span><span class="p">,</span>
                <span class="s2">&quot;preferredcodec&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_format</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;preferredquality&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_bitrate</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;outtmpl&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">dl_loc</span> <span class="o">/</span> <span class="s2">&quot;</span><span class="si">%(title)s</span><span class="s2">.tmp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
    <span class="p">}</span>

    <span class="k">with</span> <span class="n">ytdl</span><span class="o">.</span><span class="n">YoutubeDL</span><span class="p">(</span><span class="n">ydl_opts</span><span class="p">)</span> <span class="k">as</span> <span class="n">ydl</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">url_download</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">dl_loc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">ydl</span><span class="o">.</span><span class="n">download</span><span class="p">([</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">url_download</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">_file</span> <span class="ow">in</span> <span class="n">dl_loc</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="p">(</span><span class="n">dl_loc</span> <span class="o">/</span> <span class="n">_file</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">dl_loc</span> <span class="o">/</span> <span class="n">fix_up</span><span class="p">(</span><span class="n">_file</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.utils.helpers"></a>
    <div class="doc doc-contents first">

        <p>This module contains helper functions that are not specific to any
particular sub-package of this library.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.compute_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_distance</span><span class="p">(</span><span class="n">spotify_playlist</span><span class="p">,</span> <span class="n">spotify_track</span><span class="p">,</span> <span class="n">beatcloud_track</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Qualifies a match between a Spotify track and a beatcloud track using
    Levenshtein similarity.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spotify_playlist</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist that Spotify track belongs to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>spotify_track</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spotify track title and artist name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beatcloud_track</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Beatcloud track title and artist name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Levenshtein similarity threshold for acceptance.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of Spotify playlist, Spotify "TRACK TITLE - ARTIST NAME",
beatcloud "TRACK TITLE - ARTIST NAME", Levenshtein similarity.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_distance</span><span class="p">(</span>
    <span class="n">spotify_playlist</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">spotify_track</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">beatcloud_track</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Qualifies a match between a Spotify track and a beatcloud track using</span>
<span class="sd">        Levenshtein similarity.</span>

<span class="sd">    Args:</span>
<span class="sd">        spotify_playlist: Playlist that Spotify track belongs to.</span>
<span class="sd">        spotify_track: Spotify track title and artist name.</span>
<span class="sd">        beatcloud_track: Beatcloud track title and artist name</span>
<span class="sd">        threshold: Levenshtein similarity threshold for acceptance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of Spotify playlist, Spotify &quot;TRACK TITLE - ARTIST NAME&quot;,</span>
<span class="sd">            beatcloud &quot;TRACK TITLE - ARTIST NAME&quot;, Levenshtein similarity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">fuzz_ratio</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">ratio</span><span class="p">(</span><span class="n">spotify_track</span><span class="p">,</span> <span class="n">beatcloud_track</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">fuzz_ratio</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">spotify_playlist</span><span class="p">,</span> <span class="n">spotify_track</span><span class="p">,</span> <span class="n">beatcloud_track</span><span class="p">,</span> <span class="n">fuzz_ratio</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.find_matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_matches</span><span class="p">(</span><span class="n">compare_tracks</span><span class="p">,</span> <span class="n">beatcloud_tracks</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the Levenshtein similarity between beatcloud tracks the given
    tracks to compare with and returns those that match above a threshold.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>compare_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Set">Set</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with either local directory or Spotify
playlist keys and filenames or title and artists values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beatcloud_tracks</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Beatcloud track titles and artist names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.helpers.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tuples of track location (directory or playlist), track name,
Beatcloud track, and Levenshtein distance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_matches</span><span class="p">(</span>
    <span class="n">compare_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">beatcloud_tracks</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the Levenshtein similarity between beatcloud tracks the given</span>
<span class="sd">        tracks to compare with and returns those that match above a threshold.</span>

<span class="sd">    Args:</span>
<span class="sd">        compare_tracks: Dictionary with either local directory or Spotify</span>
<span class="sd">            playlist keys and filenames or title and artists values.</span>
<span class="sd">        beatcloud_tracks: Beatcloud track titles and artist names.</span>
<span class="sd">        config: Configuration object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of tuples of track location (directory or playlist), track name,</span>
<span class="sd">            Beatcloud track, and Levenshtein distance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">playlist_tracks</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">track</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">playlist</span><span class="p">,</span> <span class="n">tracks</span> <span class="ow">in</span> <span class="n">compare_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span>
    <span class="p">]</span>
    <span class="n">_product</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">playlist_tracks</span><span class="p">,</span> <span class="n">beatcloud_tracks</span><span class="p">))</span>
    <span class="n">_temp</span><span class="p">,</span> <span class="n">beatcloud_tracks</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">_product</span><span class="p">)</span>
    <span class="n">locations</span><span class="p">,</span> <span class="n">tracks</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">_temp</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">locations</span><span class="p">,</span>
        <span class="n">tracks</span><span class="p">,</span>
        <span class="n">beatcloud_tracks</span><span class="p">,</span>
        <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">check_tracks_fuzz_ratio</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">_product</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
        <span class="n">max_workers</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># pylint: disable=no-member</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">compute_distance</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">payload</span>
        <span class="p">]</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Matching new tracks and Beatcloud tracks&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">matches</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.get_beatcloud_tracks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_beatcloud_tracks</span><span class="p">(</span><span class="n">bucket_url</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Lists all the music files in S3 and parses out the track titles and
    artist names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bucket_url</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL to an AWS S3 API compliant bucket.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Beatcloud track titles and artist names.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_beatcloud_tracks</span><span class="p">(</span><span class="n">bucket_url</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists all the music files in S3 and parses out the track titles and</span>
<span class="sd">        artist names.</span>

<span class="sd">    Args:</span>
<span class="sd">        bucket_url: URL to an AWS S3 API compliant bucket.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Beatcloud track titles and artist names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aws&quot;</span><span class="p">,</span> <span class="s2">&quot;s3&quot;</span><span class="p">,</span> <span class="s2">&quot;ls&quot;</span><span class="p">,</span> <span class="s2">&quot;--recursive&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bucket_url</span><span class="si">}</span><span class="s2">/dj/music/&quot;</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">track</span><span class="p">)</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">output</span> <span class="k">if</span> <span class="n">track</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span><span class="si">}</span><span class="s2"> tracks from the beatcloud&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.get_local_tracks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_local_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Aggregates the files from one or more local directories in a dictionary
    mapped with parent directories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.helpers.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Local file names keyed by parent directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_local_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aggregates the files from one or more local directories in a dictionary</span>
<span class="sd">        mapped with parent directories.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Local file names keyed by parent directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">local_dir_tracks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">_dir</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">local_dirs</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_dir</span><span class="si">}</span><span class="s2"> does not exist; will not be able to check its &quot;</span>
                <span class="s2">&quot;contents against the beatcloud&quot;</span>
            <span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;**/*.*&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">local_dir_tracks</span><span class="p">[</span><span class="n">_dir</span><span class="p">]</span> <span class="o">=</span> <span class="n">files</span>
    <span class="n">local_tracks_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">local_dir_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="n">local_tracks_count</span><span class="si">}</span><span class="s2"> files under local directories&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">local_dir_tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.get_playlist_tracks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_playlist_tracks</span><span class="p">(</span><span class="n">spotify</span><span class="p">,</span> <span class="n">playlist_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Queries Spotify API for a playlist and pulls tracks from it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>spotify</code>
            </td>
            <td>
                  <code><span title="spotipy.Spotify">Spotify</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spotify client.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist ID of Spotify playlist to pull tracks from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist_id must correspond with a valid Spotify playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Spotify track results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_playlist_tracks</span><span class="p">(</span>
    <span class="n">spotify</span><span class="p">:</span> <span class="n">spotipy</span><span class="o">.</span><span class="n">Spotify</span><span class="p">,</span> <span class="n">playlist_id</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Queries Spotify API for a playlist and pulls tracks from it.</span>

<span class="sd">    Args:</span>
<span class="sd">        spotify: Spotify client.</span>
<span class="sd">        playlist_id: Playlist ID of Spotify playlist to pull tracks from.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: Playlist_id must correspond with a valid Spotify playlist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Spotify track results.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">playlist</span> <span class="o">=</span> <span class="n">spotify</span><span class="o">.</span><span class="n">playlist</span><span class="p">(</span><span class="n">playlist_id</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to get playlist with ID </span><span class="si">{</span><span class="n">playlist_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">Exception</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">playlist</span><span class="p">[</span><span class="s2">&quot;tracks&quot;</span><span class="p">]</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">])</span>
    <span class="k">while</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;next&quot;</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">spotify</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">tracks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.get_spotify_tracks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_spotify_tracks</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">playlists</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Aggregates the tracks from one or more Spotify playlists into a
    dictionary mapped with playlist names.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.helpers.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlists</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Spotify playlist name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Spotify tracks keyed by playlist name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_spotify_tracks</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aggregates the tracks from one or more Spotify playlists into a</span>
<span class="sd">        dictionary mapped with playlist names.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        playlists: List of Spotify playlist name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Spotify tracks keyed by playlist name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">spotify</span> <span class="o">=</span> <span class="n">get_spotify_client</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    <span class="n">playlist_ids</span> <span class="o">=</span> <span class="n">get_playlist_ids</span><span class="p">()</span>

    <span class="n">playlist_tracks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_sum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlists</span><span class="p">:</span>
        <span class="n">playlist_id</span> <span class="o">=</span> <span class="n">playlist_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_id</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist</span><span class="si">}</span><span class="s2"> not in spotify_playlists.yaml&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">playlist_tracks</span><span class="p">[</span><span class="n">playlist</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_playlist_tracks</span><span class="p">(</span><span class="n">spotify</span><span class="p">,</span> <span class="n">playlist_id</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">playlist_tracks</span><span class="p">[</span><span class="n">playlist</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s1"> track</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="si">}</span><span class="s1"> from Spotify &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;playlist &quot;</span><span class="si">{</span><span class="n">playlist</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="p">)</span>
        <span class="n">_sum</span> <span class="o">+=</span> <span class="n">length</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">playlist_tracks</span><span class="p">[</span><span class="n">playlist</span><span class="p">]:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">track</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Got </span><span class="si">{</span><span class="n">_sum</span><span class="si">}</span><span class="s1"> track</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">_sum</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;s&quot;</span><span class="si">}</span><span class="s1"> from Spotify in total&#39;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">playlist_tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.initialize_logger" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">initialize_logger</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initializes logger from configuration.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="logging.Logger">Logger</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple containing Logger and associated log file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">initialize_logger</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes logger from configuration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple containing Logger and associated log file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_file</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
        <span class="o">/</span> <span class="s2">&quot;logs&quot;</span>
        <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.log&#39;</span>
    <span class="p">)</span>
    <span class="n">logging_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;disable_existing_loggers&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s2">&quot;formatters&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;baseFormatter&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> - </span><span class="si">%(name)s</span><span class="s2">:</span><span class="si">%(lineno)s</span><span class="s2"> - </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;datefmt&quot;</span><span class="p">:</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;fileHandler&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;logging.FileHandler&quot;</span><span class="p">,</span>
                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;formatter&quot;</span><span class="p">:</span> <span class="s2">&quot;baseFormatter&quot;</span><span class="p">,</span>
                <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">log_file</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
            <span class="p">},</span>
            <span class="s2">&quot;streamHandler&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;logging.StreamHandler&quot;</span><span class="p">,</span>
                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;formatter&quot;</span><span class="p">:</span> <span class="s2">&quot;baseFormatter&quot;</span><span class="p">,</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="s2">&quot;ext://sys.stdout&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;loggers&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># root logger</span>
                <span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fileHandler&quot;</span><span class="p">,</span> <span class="s2">&quot;streamHandler&quot;</span><span class="p">],</span>
                <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;DEBUG&quot;</span><span class="p">,</span>
                <span class="s2">&quot;propagate&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">logging_config</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">),</span> <span class="n">log_file</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.make_path" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_path</span><span class="p">(</span><span class="n">func</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Decorator for converting Path-typed args to Paths.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Callable being decorated with this function.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>args annotated with a pathlib.Path need to be able to
have Paths created from them.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>kwargs annotated with a pathlib.Path need to be able to
have Paths created from them.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Callable being wrapped by this decorator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_path</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator for converting Path-typed args to Paths.</span>

<span class="sd">    Args:</span>
<span class="sd">        func: Callable being decorated with this function.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: args annotated with a pathlib.Path need to be able to</span>
<span class="sd">            have Paths created from them.</span>
<span class="sd">        RuntimeError: kwargs annotated with a pathlib.Path need to be able to</span>
<span class="sd">            have Paths created from them.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Callable being wrapped by this decorator.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@wraps</span><span class="p">(</span><span class="n">make_path</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">str_to_path</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts non-Path type args into Paths if annotated as Paths.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: args annotated with a pathlib.Path need to be able to</span>
<span class="sd">                have Paths created from them.</span>
<span class="sd">            RuntimeError: kwargs annotated with a pathlib.Path need to be able</span>
<span class="sd">                to have Paths created from them.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the function&#39;s type annotations and partition them by args and</span>
        <span class="c1"># kwargs.</span>
        <span class="n">path_types</span> <span class="o">=</span> <span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
        <span class="n">num_args</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">num_kwargs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">type_hints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">typing</span><span class="o">.</span><span class="n">get_type_hints</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;self&quot;</span><span class="p">:</span>
                <span class="n">type_hints</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;self&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">num_kwargs</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">num_args</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">arg_type_hints</span> <span class="o">=</span> <span class="n">type_hints</span><span class="p">[:</span><span class="n">num_args</span><span class="p">]</span>
        <span class="n">kwarg_type_hints</span> <span class="o">=</span> <span class="n">type_hints</span><span class="p">[:</span><span class="n">num_kwargs</span><span class="p">]</span>

        <span class="c1"># Convert each arg to a Path if the annotation type is pathlib.Path.</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">arg_type</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">arg_type_hints</span><span class="p">)):</span>
            <span class="c1"># Skip if the arg shouldn&#39;t be a path or it should be a Path but</span>
            <span class="c1"># already is.</span>
            <span class="k">if</span> <span class="n">arg_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path_types</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">arg_type</span> <span class="ow">in</span> <span class="n">path_types</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">args</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Error creating Path in function &quot;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&quot; from positional arg &quot;</span><span class="si">{</span><span class="n">arg</span><span class="si">}</span><span class="s1">&quot; annotated &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;with type &quot;</span><span class="si">{</span><span class="n">arg_type</span><span class="si">}</span><span class="s1">&quot;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">Exception</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

        <span class="c1"># Convert each kwarg to a Path if the annotation type is pathlib.Path.</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">),</span> <span class="n">arg_type</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">kwarg_type_hints</span><span class="p">):</span>
            <span class="c1"># Skip if the arg value shouldn&#39;t be a path or it should be a Path</span>
            <span class="c1"># but already is.</span>
            <span class="k">if</span> <span class="n">arg_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">path_types</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">arg_type</span> <span class="ow">in</span> <span class="n">path_types</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Error creating Path in function &quot;</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&quot; from keyword arg &quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot; &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;annotated with type &quot;</span><span class="si">{</span><span class="n">arg_type</span><span class="si">}</span><span class="s1">&quot;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">Exception</span>

        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">str_to_path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.process_parallel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">process_parallel</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">audio</span><span class="p">,</span> <span class="n">track</span><span class="p">,</span> <span class="n">write_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Normalize and export track with tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.utils.helpers.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>audio</code>
            </td>
            <td>
                  <code><span title="pydub.AudioSegment">AudioSegment</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Audio for a track.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata for track audio.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>write_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Destination for exported audio.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path that the file was written to.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_parallel</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">audio</span><span class="p">:</span> <span class="n">AudioSegment</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">write_path</span><span class="p">:</span> <span class="n">Path</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize and export track with tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        audio: Audio for a track.</span>
<span class="sd">        track: Metadata for track audio.</span>
<span class="sd">        write_path: Destination for exported audio.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path that the file was written to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normalize the audio such that the headroom is</span>
    <span class="c1"># audio_headroom dB.</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">max_dBFS</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_headroom</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.001</span><span class="p">:</span>
        <span class="n">audio</span> <span class="o">=</span> <span class="n">effects</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">headroom</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_headroom</span><span class="p">)</span>

    <span class="c1"># Build the filename using the title, artist(s) and configured format.</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;artist&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">sync</span><span class="o">.</span><span class="n">artist_first</span>
        <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">track</span><span class="p">[</span><span class="s2">&quot;artist&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">write_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_format</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Warn users about malformed filenames that could break other features</span>
    <span class="c1"># of djtools.</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1"> has more than one occurrence of &quot; - &quot;! &#39;</span>
            <span class="s2">&quot;Because djtools splits on this sequence of characters to &quot;</span>
            <span class="s2">&quot;separate track title and artist(s), you might get unexpected &quot;</span>
            <span class="s1">&#39;behavior while using features like &quot;--check-tracks&quot;.&#39;</span>
        <span class="p">)</span>

    <span class="c1"># Export the audio with the configured format and bit rate with the tag</span>
    <span class="c1"># data collected from the Spotify response.</span>
    <span class="n">audio</span><span class="o">.</span><span class="n">export</span><span class="p">(</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_format</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">bitrate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">audio_bitrate</span><span class="si">}</span><span class="s2">k&quot;</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;duration&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">filename</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.reverse_title_and_artist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reverse_title_and_artist</span><span class="p">(</span><span class="n">path_lookup</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reverses the title and artist parts of the filename.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path_lookup</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of filenames to file paths.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping with the title and artist in the filenames reversed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reverse_title_and_artist</span><span class="p">(</span><span class="n">path_lookup</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reverses the title and artist parts of the filename.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_lookup: Mapping of filenames to file paths.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mapping with the title and artist in the filenames reversed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_path_lookup</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">path_lookup</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">split</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot; - &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">split</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">artist</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">new_path_lookup</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">artist</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">new_path_lookup</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.utils.helpers.trim_initial_silence" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trim_initial_silence</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">track_durations</span><span class="p">,</span> <span class="n">trim_amount</span><span class="p">,</span> <span class="n">silence_thresh</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_silence_ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Heuristic for determining the amount of leading silence to trim.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>audio</code>
            </td>
            <td>
                  <code><span title="pydub.AudioSegment">AudioSegment</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Audio with leading silence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track_durations</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of track durations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>trim_amount</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="djtools.utils.config.TrimInitialSilenceMode">TrimInitialSilenceMode</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of milliseconds to trim off the beginning.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>silence_thresh</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum decibel level that's still considered silence.</p>
              </div>
            </td>
            <td>
                  <code>-50</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>min_silence_ms</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Surrounding milliseconds of each track to check for
silence.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial step size when checking for leading silences.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>AudioSegment</code></td>            <td>
                  <code><span title="pydub.AudioSegment">AudioSegment</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Audio with the beginning silence trimmed off.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/utils/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trim_initial_silence</span><span class="p">(</span>
    <span class="n">audio</span><span class="p">:</span> <span class="n">AudioSegment</span><span class="p">,</span>
    <span class="n">track_durations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="n">trim_amount</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">TrimInitialSilenceMode</span><span class="p">],</span>
    <span class="n">silence_thresh</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">min_silence_ms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">step_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AudioSegment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Heuristic for determining the amount of leading silence to trim.</span>

<span class="sd">    Args:</span>
<span class="sd">        audio: Audio with leading silence.</span>
<span class="sd">        track_durations: List of track durations.</span>
<span class="sd">        trim_amount: Number of milliseconds to trim off the beginning.</span>
<span class="sd">        silence_thresh: Maximum decibel level that&#39;s still considered silence.</span>
<span class="sd">        min_silence_ms: Surrounding milliseconds of each track to check for</span>
<span class="sd">            silence.</span>
<span class="sd">        step_size: Initial step size when checking for leading silences.</span>

<span class="sd">    Returns:</span>
<span class="sd">        AudioSegment: Audio with the beginning silence trimmed off.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If trim_amount is an integer, then it&#39;s the number of milliseconds to</span>
    <span class="c1"># trim off the beginning of the recording. If a negative integer is</span>
    <span class="c1"># provided, then insert that many milliseconds of silence at the beginning</span>
    <span class="c1"># of the recording.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trim_amount</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">trim_amount</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">audio</span><span class="p">[</span><span class="n">trim_amount</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">AudioSegment</span><span class="o">.</span><span class="n">silent</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">trim_amount</span><span class="p">))</span> <span class="o">+</span> <span class="n">audio</span>

    <span class="c1"># Get the number of milliseconds of silence at the beginning of the</span>
    <span class="c1"># recording.</span>
    <span class="n">leading_silence</span> <span class="o">=</span> <span class="n">silence</span><span class="o">.</span><span class="n">detect_leading_silence</span><span class="p">(</span>
        <span class="n">audio</span><span class="p">,</span> <span class="n">silence_threshold</span><span class="o">=</span><span class="n">silence_thresh</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="c1"># If trim_amount is &quot;auto&quot;, simply trim off the detected leading silence.</span>
    <span class="k">if</span> <span class="n">trim_amount</span> <span class="o">==</span> <span class="n">TrimInitialSilenceMode</span><span class="o">.</span><span class="n">AUTO</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">audio</span><span class="p">[</span><span class="n">leading_silence</span><span class="p">:]</span>

    <span class="c1"># Use the track durations to infer the points in the recording where each</span>
    <span class="c1"># track should begin.</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">track_duration</span> <span class="ow">in</span> <span class="n">track_durations</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="n">track_duration</span>
        <span class="n">start_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># With a logarithmically decreasing step size, step through the potential</span>
    <span class="c1"># offsets to trim off the beginning of the recording.</span>
    <span class="n">step_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">step_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">offsets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">leading_silence</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">step_size</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">offsets</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
            <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c1"># For each track in the recording, build up a score based on the</span>
            <span class="c1"># number of surrounding milliseconds of silence.</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">start_points</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">millisecond</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_silence_ms</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">audio</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">point</span> <span class="o">+</span> <span class="n">millisecond</span><span class="p">]</span><span class="o">.</span><span class="n">dBFS</span>
                        <span class="o">&lt;=</span> <span class="n">silence_thresh</span>
                    <span class="p">):</span>
                        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="n">audio</span><span class="p">[</span><span class="n">offset</span> <span class="o">+</span> <span class="n">point</span> <span class="o">-</span> <span class="n">millisecond</span><span class="p">]</span><span class="o">.</span><span class="n">dBFS</span>
                        <span class="o">&lt;=</span> <span class="n">silence_thresh</span>
                    <span class="p">):</span>
                        <span class="n">score</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">score</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>

        <span class="c1"># Sort scores in decreasing order.</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Get the offsets for the highest two scores.</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">step_size</span> <span class="o">//=</span> <span class="mi">2</span>

    <span class="c1"># Trim off the start of the recording using the best offset.</span>
    <span class="n">best_offset</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">audio</span><span class="p">[</span><span class="n">best_offset</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">audio</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>