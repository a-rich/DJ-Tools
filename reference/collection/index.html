
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../configs/">
      
      
        <link rel="next" href="../spotify/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Collection - DJ Tools</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#collection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DJ Tools" class="md-header__button md-logo" aria-label="DJ Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DJ Tools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Collection
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/a-rich/DJ-Tools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DJ Tools" class="md-nav__button md-logo" aria-label="DJ Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DJ Tools
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/a-rich/DJ-Tools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-to Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-to Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Collection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Collection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/collection_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build Playlists From Tags
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/combiner_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Combine Playlists With Boolean Algebra
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/copy_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copy Tracks From Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/shuffle_playlists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shuffle Tracks in Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Spotify
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Spotify
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/reddit_spotify_api_access/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup Reddit & Spotify API Access
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/spotify_playlist_from_upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Spotify Playlists From Other Users' Uploads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/spotify_playlist_from_reddit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Create Spotify Playlists From Reddit Posts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Sync
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/setup_object_storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup Object Storage For Syncing Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/sync_beatcloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Files with the Beatcloud
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/sync_spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Tracks From Spotify Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/check_beatcloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Check the Beatcloud for Tracks in Spotify Playlists or Local Directories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/extract_from_url/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extract Audio Files From URLs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/process_recordings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Process Recorded Files Using Spotify Playlists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how_to_guides/standardize_audio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standardize Audio Files
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conceptual Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Conceptual Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/rekordbox_collection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get to Know Your Rekordbox Collection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/tagging_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tagging Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conceptual_guides/file_standardization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Importance of Standardization and Quality Control
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Collection
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Collection
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#djtools.collection" class="md-nav__link">
    <span class="md-ellipsis">
      collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxPlaylist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxPlaylist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.get_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.is_folder" class="md-nav__link">
    <span class="md-ellipsis">
      is_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.new_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      new_playlist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxTrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxTrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_artists" class="md-nav__link">
    <span class="md-ellipsis">
      get_artists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_bpm" class="md-nav__link">
    <span class="md-ellipsis">
      get_bpm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_comments" class="md-nav__link">
    <span class="md-ellipsis">
      get_comments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_date_added" class="md-nav__link">
    <span class="md-ellipsis">
      get_date_added
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_genre_tags" class="md-nav__link">
    <span class="md-ellipsis">
      get_genre_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_label" class="md-nav__link">
    <span class="md-ellipsis">
      get_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_rating" class="md-nav__link">
    <span class="md-ellipsis">
      get_rating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      get_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.set_location" class="md-nav__link">
    <span class="md-ellipsis">
      set_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.set_track_number" class="md-nav__link">
    <span class="md-ellipsis">
      set_track_number
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.collection_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      collection_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.CollectionConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CollectionConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CollectionConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.config.CollectionConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistConfigContent" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistConfigContent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistFilters" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistFilters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistName" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistName
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistRemainder" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistRemainder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.RegisteredPlatforms" class="md-nav__link">
    <span class="md-ellipsis">
      RegisteredPlatforms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_builder" class="md-nav__link">
    <span class="md-ellipsis">
      playlist_builder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_builder.collection_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      collection_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters" class="md-nav__link">
    <span class="md-ellipsis">
      playlist_filters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter" class="md-nav__link">
    <span class="md-ellipsis">
      ComplexTrackFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ComplexTrackFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter" class="md-nav__link">
    <span class="md-ellipsis">
      HipHopFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HipHopFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter" class="md-nav__link">
    <span class="md-ellipsis">
      MinimalDeepTechFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MinimalDeepTechFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlaylistFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter" class="md-nav__link">
    <span class="md-ellipsis">
      TransitionTrackFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransitionTrackFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.shuffle_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      shuffle_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.shuffle_playlists.shuffle_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      shuffle_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.copy_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      copy_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.copy_playlists.copy_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      copy_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers" class="md-nav__link">
    <span class="md-ellipsis">
      helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode" class="md-nav__link">
    <span class="md-ellipsis">
      BooleanNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BooleanNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.add_operand" class="md-nav__link">
    <span class="md-ellipsis">
      add_operand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.add_operator" class="md-nav__link">
    <span class="md-ellipsis">
      add_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.get_parent" class="md-nav__link">
    <span class="md-ellipsis">
      get_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.is_operator" class="md-nav__link">
    <span class="md-ellipsis">
      is_operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.add_selectors_to_tags" class="md-nav__link">
    <span class="md-ellipsis">
      add_selectors_to_tags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.aggregate_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.build_combiner_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      build_combiner_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.build_tag_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      build_tag_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.copy_file" class="md-nav__link">
    <span class="md-ellipsis">
      copy_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.filter_tag_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      filter_tag_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_expression" class="md-nav__link">
    <span class="md-ellipsis">
      parse_expression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_numerical_selectors" class="md-nav__link">
    <span class="md-ellipsis">
      parse_numerical_selectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_string_selectors" class="md-nav__link">
    <span class="md-ellipsis">
      parse_string_selectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      parse_timedelta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.print_data" class="md-nav__link">
    <span class="md-ellipsis">
      print_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.print_playlists_tag_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      print_playlists_tag_statistics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.scale_data" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spotify
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer Docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developer Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/system_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    System Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/new_collections/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding DJ Software Support to the Collections Package
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/collections_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using the Collections API
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer_docs/playlist_filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Adding Custom PlaylistFilters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#djtools.collection" class="md-nav__link">
    <span class="md-ellipsis">
      collection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxCollection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxCollection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxCollection.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxPlaylist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxPlaylist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.get_name" class="md-nav__link">
    <span class="md-ellipsis">
      get_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.is_folder" class="md-nav__link">
    <span class="md-ellipsis">
      is_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.new_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      new_playlist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxPlaylist.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack" class="md-nav__link">
    <span class="md-ellipsis">
      RekordboxTrack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RekordboxTrack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_artists" class="md-nav__link">
    <span class="md-ellipsis">
      get_artists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_bpm" class="md-nav__link">
    <span class="md-ellipsis">
      get_bpm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_comments" class="md-nav__link">
    <span class="md-ellipsis">
      get_comments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_date_added" class="md-nav__link">
    <span class="md-ellipsis">
      get_date_added
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_genre_tags" class="md-nav__link">
    <span class="md-ellipsis">
      get_genre_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_key" class="md-nav__link">
    <span class="md-ellipsis">
      get_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_label" class="md-nav__link">
    <span class="md-ellipsis">
      get_label
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_location" class="md-nav__link">
    <span class="md-ellipsis">
      get_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_rating" class="md-nav__link">
    <span class="md-ellipsis">
      get_rating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_tags" class="md-nav__link">
    <span class="md-ellipsis">
      get_tags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.get_year" class="md-nav__link">
    <span class="md-ellipsis">
      get_year
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.serialize" class="md-nav__link">
    <span class="md-ellipsis">
      serialize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.set_location" class="md-nav__link">
    <span class="md-ellipsis">
      set_location
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.RekordboxTrack.set_track_number" class="md-nav__link">
    <span class="md-ellipsis">
      set_track_number
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.collection_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      collection_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config" class="md-nav__link">
    <span class="md-ellipsis">
      config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.CollectionConfig" class="md-nav__link">
    <span class="md-ellipsis">
      CollectionConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CollectionConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.config.CollectionConfig.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistConfig" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistConfig
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistConfigContent" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistConfigContent
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistFilters" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistFilters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistName" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistName
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.PlaylistRemainder" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistRemainder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.config.RegisteredPlatforms" class="md-nav__link">
    <span class="md-ellipsis">
      RegisteredPlatforms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_builder" class="md-nav__link">
    <span class="md-ellipsis">
      playlist_builder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_builder.collection_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      collection_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters" class="md-nav__link">
    <span class="md-ellipsis">
      playlist_filters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter" class="md-nav__link">
    <span class="md-ellipsis">
      ComplexTrackFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ComplexTrackFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.ComplexTrackFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter" class="md-nav__link">
    <span class="md-ellipsis">
      HipHopFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HipHopFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.HipHopFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter" class="md-nav__link">
    <span class="md-ellipsis">
      MinimalDeepTechFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MinimalDeepTechFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.MinimalDeepTechFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter" class="md-nav__link">
    <span class="md-ellipsis">
      PlaylistFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PlaylistFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.PlaylistFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter" class="md-nav__link">
    <span class="md-ellipsis">
      TransitionTrackFilter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TransitionTrackFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.filter_track" class="md-nav__link">
    <span class="md-ellipsis">
      filter_track
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.playlist_filters.TransitionTrackFilter.is_filter_playlist" class="md-nav__link">
    <span class="md-ellipsis">
      is_filter_playlist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.shuffle_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      shuffle_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.shuffle_playlists.shuffle_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      shuffle_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.copy_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      copy_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.copy_playlists.copy_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      copy_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers" class="md-nav__link">
    <span class="md-ellipsis">
      helpers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode" class="md-nav__link">
    <span class="md-ellipsis">
      BooleanNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BooleanNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.add_operand" class="md-nav__link">
    <span class="md-ellipsis">
      add_operand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.add_operator" class="md-nav__link">
    <span class="md-ellipsis">
      add_operator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      evaluate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.get_parent" class="md-nav__link">
    <span class="md-ellipsis">
      get_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#djtools.collection.helpers.BooleanNode.is_operator" class="md-nav__link">
    <span class="md-ellipsis">
      is_operator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.add_selectors_to_tags" class="md-nav__link">
    <span class="md-ellipsis">
      add_selectors_to_tags
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.aggregate_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      aggregate_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.build_combiner_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      build_combiner_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.build_tag_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      build_tag_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.copy_file" class="md-nav__link">
    <span class="md-ellipsis">
      copy_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.filter_tag_playlists" class="md-nav__link">
    <span class="md-ellipsis">
      filter_tag_playlists
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_expression" class="md-nav__link">
    <span class="md-ellipsis">
      parse_expression
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_numerical_selectors" class="md-nav__link">
    <span class="md-ellipsis">
      parse_numerical_selectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_string_selectors" class="md-nav__link">
    <span class="md-ellipsis">
      parse_string_selectors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.parse_timedelta" class="md-nav__link">
    <span class="md-ellipsis">
      parse_timedelta
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.print_data" class="md-nav__link">
    <span class="md-ellipsis">
      print_data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.print_playlists_tag_statistics" class="md-nav__link">
    <span class="md-ellipsis">
      print_playlists_tag_statistics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#djtools.collection.helpers.scale_data" class="md-nav__link">
    <span class="md-ellipsis">
      scale_data
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="collection">Collection</h1>


<div class="doc doc-object doc-module">



<a id="djtools.collection"></a>
    <div class="doc doc-contents first">

        <p>The <code>collection</code> package contains modules:</p>
<ul>
<li><code>base_collection</code>: abstraction for Collection</li>
<li><code>base_playlist</code>: abstraction for Playlist</li>
<li><code>base_track</code>: abstraction for Track</li>
<li><code>config</code>: the configuration object for the <code>collection</code> package</li>
<li><code>copy_playlists</code>: copies audio files for tracks within a set of
    playlists to a new location and writes a new collection with these
    updated paths</li>
<li><code>helpers</code>: contains helper classes and functions for the other modules of
    this package</li>
<li><code>playlist_builder</code>: constructs playlists using tags in a Collection and a
    defined playlist structure in
    <code>collection_playlists.yaml</code></li>
<li><code>playlist_filters</code>: abstractions and implementations for playlist filters</li>
<li><code>playlists</code>: abstractions and implementations for playlists</li>
<li><code>rekordbox_collection</code>: implementation of Collection for Rekordbox</li>
<li><code>rekordbox_playlist</code>: implementation of Playlist for Rekordbox</li>
<li><code>rekordbox_track</code>: implementation of Track for Rekordbox</li>
<li><code>shuffle_playlists</code>: writes sequential numbers to tags of shuffled tracks
    in playlists to emulate playlist shuffling</li>
<li><code>tracks</code>: abstractions and implementations for tracks</li>
</ul>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="djtools.collection.RekordboxCollection" class="doc doc-heading">
            <code>RekordboxCollection</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="djtools.collection.base_collection.Collection">Collection</span></code></p>


        <p>Collection implementation for usage with Rekordbox.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/rekordbox_collection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RekordboxCollection</span><span class="p">(</span><span class="n">Collection</span><span class="p">):</span>
    <span class="s2">&quot;Collection implementation for usage with Rekordbox.&quot;</span>

    <span class="nd">@make_path</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deserializes a Collection from an XML file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to a serialized collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>

        <span class="c1"># Parse the XML as a BeautifulSoup document.</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">&quot;xml&quot;</span><span class="p">)</span>

        <span class="c1"># Create a dict of tracks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">track</span><span class="p">[</span><span class="s2">&quot;TrackID&quot;</span><span class="p">]:</span> <span class="n">RekordboxTrack</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;TRACK&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Location&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Instantiate the Playlist(s) in this collection.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="n">RekordboxPlaylist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;ROOT&quot;</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">}),</span>
            <span class="n">tracks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produce a string representation of this Collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Collection represented as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Eventual repr string to return.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="se">\n</span><span class="s2">)&quot;</span>
        <span class="c1"># Body to the repr string to fill out with Collection content.</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># Dunder methods aren&#39;t represented. Public members (i.e methods)</span>
        <span class="c1"># aren&#39;t represented either.</span>
        <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_collection&quot;</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Build a representation of this Collection.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Skip representing this collection&#39;s playlists and tracks.</span>
            <span class="c1"># Defer representation of the playlists attribute until the end.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="c1"># Represent string values with surrounding double quotes.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

            <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,&quot;</span>

        <span class="c1"># Represent the tracks attribute as the number of tracks.</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">tracks=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repr_attrs</span><span class="p">[</span><span class="s1">&#39;tracks&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">,&quot;</span>

        <span class="c1"># Represent the playlists attribute as the total number of playlists.</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">])</span>
        <span class="n">playlist_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="n">playlist</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="n">playlist_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">playlists=</span><span class="si">{</span><span class="n">playlist_count</span><span class="si">}</span><span class="s2">,&quot;</span>

        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="nd">@make_path</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes this Collection as an XML file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to output serialized collection to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path to the serialized collection XML file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># BeautifulSoup document.</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span>

        <span class="c1"># Tag that contains all the playlist data.</span>
        <span class="n">root_tag_name</span> <span class="o">=</span> <span class="s2">&quot;DJ_PLAYLISTS&quot;</span>

        <span class="c1"># Retrieve this root tag from the existing document, rather than</span>
        <span class="c1"># building it from scratch, in case the attributes ever change.</span>
        <span class="n">root_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">root_tag_name</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">root_tag_name</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Similarly, we want to reference the existing attribute data on the</span>
        <span class="c1"># product Tag.</span>
        <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;PRODUCT&quot;</span><span class="p">))]</span>
        <span class="p">)</span>

        <span class="c1"># Build the collection Tag and serialize each track into it before</span>
        <span class="c1"># adding the collection Tag to the root.</span>
        <span class="n">collection_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;COLLECTION&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Entries&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="p">))}</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">collection_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">track</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
            <span class="p">)</span>
        <span class="n">collection_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">collection_tag</span><span class="p">])</span>

        <span class="c1"># Build the playlists Tag and serialize each Playlist into it before</span>
        <span class="c1"># adding the playlist Tag to the root.</span>
        <span class="n">playlists_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;PLAYLISTS&quot;</span><span class="p">)</span>
        <span class="n">playlists_root_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;ROOT&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span><span class="p">)},</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span><span class="p">:</span>
            <span class="n">playlists_root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">playlist</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
            <span class="p">)</span>
        <span class="n">playlists_root_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">playlists_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="n">playlists_root_tag</span><span class="p">,</span>
                <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="n">playlists_tag</span><span class="p">,</span>
                <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root_tag</span><span class="p">)</span>

        <span class="c1"># If no new path is provided, use the original.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

        <span class="c1"># Write the serialized Collection to a new file.</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
            <span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">prettify</span><span class="p">(</span>
                    <span class="c1"># UnsortedAttributes formatter ensures attributes are</span>
                    <span class="c1"># serialized in the same order as the original XML file.</span>
                    <span class="n">formatter</span><span class="o">=</span><span class="n">UnsortedAttributes</span><span class="p">(</span>
                        <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="c1"># CustomSubstitution is used to substitute an expanded</span>
                        <span class="c1"># character set in the serialized XML file.</span>
                        <span class="n">entity_substitution</span><span class="o">=</span><span class="n">CustomSubstitution</span><span class="o">.</span><span class="n">substitute_xml</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">path</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_xml</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_xml</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate the serialized Collection matches the original.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_xml: Path to an XML containing the original collection.</span>
<span class="sd">            output_xml: Path to an XML containing the serialized collection.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: A serialized Collection must exactly match the</span>
<span class="sd">                original XML used to deserialize from.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Read the original and serialized collection XML files as</span>
        <span class="c1"># strings.</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_xml</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
            <span class="n">input_xml_string</span> <span class="o">=</span> <span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_xml</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
            <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># Rekordbox capitalizes &quot;UTF-8&quot; in the file declaration while</span>
        <span class="c1"># BeautifulSoup does not.</span>
        <span class="n">xml_declaration</span> <span class="o">=</span> <span class="n">input_xml_string</span><span class="p">[:</span><span class="mi">38</span><span class="p">]</span>
        <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">xml_declaration</span> <span class="o">+</span> <span class="n">output_xml_string</span><span class="p">[</span><span class="mi">38</span><span class="p">:]</span>

        <span class="c1"># Replace multiple occurrences of whitespace with a single whitespace.</span>
        <span class="n">whitespace</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/\s{2,}/g&quot;</span><span class="p">)</span>
        <span class="n">input_xml_string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">whitespace</span><span class="p">,</span> <span class="n">input_xml_string</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">whitespace</span><span class="p">,</span> <span class="n">output_xml_string</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">input_xml_string</span> <span class="o">==</span> <span class="n">output_xml_string</span>
        <span class="p">),</span> <span class="s2">&quot;Failed RekordboxCollection validation!&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxCollection.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Deserializes a Collection from an XML file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a serialized collection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deserializes a Collection from an XML file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to a serialized collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="c1"># Parse the XML as a BeautifulSoup document.</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="s2">&quot;xml&quot;</span><span class="p">)</span>

    <span class="c1"># Create a dict of tracks.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">track</span><span class="p">[</span><span class="s2">&quot;TrackID&quot;</span><span class="p">]:</span> <span class="n">RekordboxTrack</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;TRACK&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Location&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Instantiate the Playlist(s) in this collection.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="n">RekordboxPlaylist</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;ROOT&quot;</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">}),</span>
        <span class="n">tracks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxCollection.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Produce a string representation of this Collection.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collection represented as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produce a string representation of this Collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Collection represented as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Eventual repr string to return.</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="se">\n</span><span class="s2">)&quot;</span>
    <span class="c1"># Body to the repr string to fill out with Collection content.</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="c1"># Dunder methods aren&#39;t represented. Public members (i.e methods)</span>
    <span class="c1"># aren&#39;t represented either.</span>
    <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_collection&quot;</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Build a representation of this Collection.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Skip representing this collection&#39;s playlists and tracks.</span>
        <span class="c1"># Defer representation of the playlists attribute until the end.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="c1"># Represent string values with surrounding double quotes.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">,&quot;</span>

    <span class="c1"># Represent the tracks attribute as the number of tracks.</span>
    <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">tracks=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">repr_attrs</span><span class="p">[</span><span class="s1">&#39;tracks&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">,&quot;</span>

    <span class="c1"># Represent the playlists attribute as the total number of playlists.</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">])</span>
    <span class="n">playlist_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">playlist</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="n">playlist_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">playlists=</span><span class="si">{</span><span class="n">playlist_count</span><span class="si">}</span><span class="s2">,&quot;</span>

    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxCollection.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Serializes this Collection as an XML file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to output serialized collection to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the serialized collection XML file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serializes this Collection as an XML file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to output serialized collection to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path to the serialized collection XML file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># BeautifulSoup document.</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span>

    <span class="c1"># Tag that contains all the playlist data.</span>
    <span class="n">root_tag_name</span> <span class="o">=</span> <span class="s2">&quot;DJ_PLAYLISTS&quot;</span>

    <span class="c1"># Retrieve this root tag from the existing document, rather than</span>
    <span class="c1"># building it from scratch, in case the attributes ever change.</span>
    <span class="n">root_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">root_tag_name</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">root_tag_name</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Similarly, we want to reference the existing attribute data on the</span>
    <span class="c1"># product Tag.</span>
    <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collection</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;PRODUCT&quot;</span><span class="p">))]</span>
    <span class="p">)</span>

    <span class="c1"># Build the collection Tag and serialize each track into it before</span>
    <span class="c1"># adding the collection Tag to the root.</span>
    <span class="n">collection_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;COLLECTION&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Entries&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="p">))}</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">collection_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">track</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
        <span class="p">)</span>
    <span class="n">collection_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">collection_tag</span><span class="p">])</span>

    <span class="c1"># Build the playlists Tag and serialize each Playlist into it before</span>
    <span class="c1"># adding the playlist Tag to the root.</span>
    <span class="n">playlists_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;PLAYLISTS&quot;</span><span class="p">)</span>
    <span class="n">playlists_root_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;ROOT&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span><span class="p">)},</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span><span class="p">:</span>
        <span class="n">playlists_root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">playlist</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
        <span class="p">)</span>
    <span class="n">playlists_root_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">playlists_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">playlists_root_tag</span><span class="p">,</span>
            <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">root_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="n">playlists_tag</span><span class="p">,</span>
            <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root_tag</span><span class="p">)</span>

    <span class="c1"># If no new path is provided, use the original.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="c1"># Write the serialized Collection to a new file.</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
        <span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">prettify</span><span class="p">(</span>
                <span class="c1"># UnsortedAttributes formatter ensures attributes are</span>
                <span class="c1"># serialized in the same order as the original XML file.</span>
                <span class="n">formatter</span><span class="o">=</span><span class="n">UnsortedAttributes</span><span class="p">(</span>
                    <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="c1"># CustomSubstitution is used to substitute an expanded</span>
                    <span class="c1"># character set in the serialized XML file.</span>
                    <span class="n">entity_substitution</span><span class="o">=</span><span class="n">CustomSubstitution</span><span class="o">.</span><span class="n">substitute_xml</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">path</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxCollection.validate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate</span><span class="p">(</span><span class="n">input_xml</span><span class="p">,</span> <span class="n">output_xml</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Validate the serialized Collection matches the original.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_xml</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to an XML containing the original collection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_xml</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to an XML containing the serialized collection.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A serialized Collection must exactly match the
original XML used to deserialize from.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_collection.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_xml</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_xml</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate the serialized Collection matches the original.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_xml: Path to an XML containing the original collection.</span>
<span class="sd">        output_xml: Path to an XML containing the serialized collection.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: A serialized Collection must exactly match the</span>
<span class="sd">            original XML used to deserialize from.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Read the original and serialized collection XML files as</span>
    <span class="c1"># strings.</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_xml</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
        <span class="n">input_xml_string</span> <span class="o">=</span> <span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_xml</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
        <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="c1"># Rekordbox capitalizes &quot;UTF-8&quot; in the file declaration while</span>
    <span class="c1"># BeautifulSoup does not.</span>
    <span class="n">xml_declaration</span> <span class="o">=</span> <span class="n">input_xml_string</span><span class="p">[:</span><span class="mi">38</span><span class="p">]</span>
    <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">xml_declaration</span> <span class="o">+</span> <span class="n">output_xml_string</span><span class="p">[</span><span class="mi">38</span><span class="p">:]</span>

    <span class="c1"># Replace multiple occurrences of whitespace with a single whitespace.</span>
    <span class="n">whitespace</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;/\s{2,}/g&quot;</span><span class="p">)</span>
    <span class="n">input_xml_string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">whitespace</span><span class="p">,</span> <span class="n">input_xml_string</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">output_xml_string</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">whitespace</span><span class="p">,</span> <span class="n">output_xml_string</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">input_xml_string</span> <span class="o">==</span> <span class="n">output_xml_string</span>
    <span class="p">),</span> <span class="s2">&quot;Failed RekordboxCollection validation!&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.RekordboxPlaylist" class="doc doc-heading">
            <code>RekordboxPlaylist</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code></p>


        <p>Playlist implementation for usage with Rekordbox.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RekordboxPlaylist</span><span class="p">(</span><span class="n">Playlist</span><span class="p">):</span>
    <span class="s2">&quot;Playlist implementation for usage with Rekordbox.&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">playlist</span><span class="p">:</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="n">tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">playlist_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deserialize a Playlist from a BeautifulSoup NODE Tag.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: BeautifulSoup Tag representing a playlist.</span>
<span class="sd">            tracks: All the tracks in this collection.</span>
<span class="sd">            playlist_tracks: Tracks to set when initializing with new_playlist.</span>
<span class="sd">            parent: The folder this playlist is in.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="n">tracks</span> <span class="o">=</span> <span class="n">tracks</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="c1"># Set this object&#39;s attributes with the NODE Tag&#39;s attributes.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">playlist</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Recursively instantiate sub-playlists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">RekordboxPlaylist</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="n">playlist</span><span class="o">.</span><span class="n">children</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="c1"># Deserialize tracks from a leaf node playlist.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Filter the children elements for Tags and get the key attribute.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_tracks</span><span class="p">:</span>
                <span class="n">playlist_tracks</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Key&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span>
                        <span class="n">playlist</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="c1"># Create a dict of tracks.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">track_id</span><span class="p">:</span> <span class="n">tracks</span><span class="p">[</span><span class="n">track_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">track_id</span> <span class="ow">in</span> <span class="n">playlist_tracks</span>
            <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this playlist.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Playlist represented as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Eventual repr string to return.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">(</span><span class="si">{}{}</span><span class="s2">)&quot;</span>
        <span class="c1"># Body of the repr string to fill out with playlist contents.</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="c1"># Get the repr recursion depth to determine the degree of indentation.</span>
        <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">frame</span>
                    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">frame</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;__repr__&quot;</span>
                    <span class="ow">and</span> <span class="n">Path</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;rekordbox_playlist.py&quot;</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="o">-</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="c1"># These variables are used to control indentation level.</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">depth</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extra</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Dunder members aren&#39;t represented. Public members (i.e. methods)</span>
        <span class="c1"># aren&#39;t represented either.</span>
        <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_parent&quot;</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_aggregate&quot;</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Build a representation of this playlist.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Skip representing this playlist&#39;s tracks.</span>
            <span class="c1"># Defer representation of the playlists attribute until the end.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="c1"># Represent string values with surrounding double quotes.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

            <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, &quot;</span>

        <span class="c1"># Truncate the final attributes trailing &quot;, &quot;.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">]:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Now represent the playlist attribute as an indented list of</span>
        <span class="c1"># sub-playlists.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;playlists&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">=[&quot;</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">depth</span><span class="si">}{</span><span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span>
            <span class="c1"># Truncate final comma.</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">],&quot;</span>

        <span class="c1"># Truncate final comma.</span>
        <span class="k">if</span> <span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">]:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">padding</span> <span class="k">if</span> <span class="n">depth</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">body</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="si">}{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produce a string representation of this playlist.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Playlist represented as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the name of this playlist.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Name</span>  <span class="c1"># pylint: disable=no-member</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns whether this playlist is a folder or a playlist of tracks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Boolean representing whether this is a folder or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Type</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>  <span class="c1"># pylint: disable=no-member</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">new_playlist</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">playlists</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">enable_aggregation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new playlist.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the Playlist to be created.</span>
<span class="sd">            playlists: A list of Playlists to add to this Playlist.</span>
<span class="sd">            tracks: A dict of Tracks to add to this Playlist.</span>
<span class="sd">            enable_aggregation: Whether or not this playlist has an aggregation</span>
<span class="sd">                playlist.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: You must provide either a list of Playlists or a list</span>
<span class="sd">                of Tracks.</span>
<span class="sd">            RuntimeError: You must not provide both a list of Playlists and a</span>
<span class="sd">                list of Tracks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;You must provide either a list of RekordboxPlaylists or a &quot;</span>
                <span class="s2">&quot;list of RekordboxTracks&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;You must not provide both a list of RekordboxPlaylists and a &quot;</span>
                <span class="s2">&quot;list of RekordboxTracks&quot;</span>
            <span class="p">)</span>
        <span class="n">playlist_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">playlists</span><span class="p">)}</span>
                <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;KeyType&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Entries&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">),</span>
                <span class="p">}</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">playlist</span> <span class="o">=</span> <span class="n">RekordboxPlaylist</span><span class="p">(</span>
            <span class="n">playlist_tag</span><span class="p">,</span>
            <span class="n">tracks</span><span class="o">=</span><span class="n">tracks</span><span class="p">,</span>
            <span class="n">playlist_tracks</span><span class="o">=</span><span class="p">(</span><span class="n">tracks</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
            <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">playlist</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="n">playlists</span>

        <span class="k">return</span> <span class="n">playlist</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes this playlist as a BeautifulSoup NODE Tag.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BeautifulSoup Tag representing this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># BeautifulSoup Tag to populate with attributes of this playlist.</span>
        <span class="n">playlist_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span> <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Dunder members aren&#39;t serialized. Public members (i.e. methods)</span>
        <span class="c1"># aren&#39;t serialized either.</span>
        <span class="n">serialize_attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_parent&quot;</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_aggregate&quot;</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Serialize attributes into a NODE Tag.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">serialize_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Playlists and tracks are serialized as nested Tag objects.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Iterate and serialize nested playlists.</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">playlist_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">val</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
                        <span class="p">)</span>
                <span class="c1"># Iterate and serialize tracks.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                        <span class="n">playlist_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                            <span class="p">[</span>
                                <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
                                <span class="n">val</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">playlist</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                            <span class="p">]</span>
                        <span class="p">)</span>

                <span class="c1"># Append a final newline character.</span>
                <span class="n">playlist_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
                <span class="k">continue</span>

            <span class="c1"># Otherwise the data is serialized as NODE Tag attributes.</span>
            <span class="n">playlist_tag</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># Update the Count or Entries attribute.</span>
        <span class="n">playlist_tag</span><span class="p">[</span><span class="s2">&quot;Count&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;Entries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">playlist_tag</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">playlist_tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Deserialize a Playlist from a BeautifulSoup NODE Tag.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="bs4.element.Tag">Tag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BeautifulSoup Tag representing a playlist.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="RekordboxTrack (djtools.collection.rekordbox_track.RekordboxTrack)" href="#djtools.collection.RekordboxTrack">RekordboxTrack</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>All the tracks in this collection.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="RekordboxTrack (djtools.collection.rekordbox_track.RekordboxTrack)" href="#djtools.collection.RekordboxTrack">RekordboxTrack</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tracks to set when initializing with new_playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="RekordboxPlaylist (djtools.collection.rekordbox_playlist.RekordboxPlaylist)" href="#djtools.collection.RekordboxPlaylist">RekordboxPlaylist</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The folder this playlist is in.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">playlist</span><span class="p">:</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="n">tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">playlist_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deserialize a Playlist from a BeautifulSoup NODE Tag.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: BeautifulSoup Tag representing a playlist.</span>
<span class="sd">        tracks: All the tracks in this collection.</span>
<span class="sd">        playlist_tracks: Tracks to set when initializing with new_playlist.</span>
<span class="sd">        parent: The folder this playlist is in.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="n">tracks</span> <span class="ow">or</span> <span class="p">{}</span>

    <span class="c1"># Set this object&#39;s attributes with the NODE Tag&#39;s attributes.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">playlist</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Recursively instantiate sub-playlists.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">RekordboxPlaylist</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span> <span class="n">playlist</span><span class="o">.</span><span class="n">children</span>
            <span class="p">)</span>
        <span class="p">]</span>
    <span class="c1"># Deserialize tracks from a leaf node playlist.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Filter the children elements for Tags and get the key attribute.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_tracks</span><span class="p">:</span>
            <span class="n">playlist_tracks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">track</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Key&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">),</span>
                    <span class="n">playlist</span><span class="o">.</span><span class="n">children</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="c1"># Create a dict of tracks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tracks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">track_id</span><span class="p">:</span> <span class="n">tracks</span><span class="p">[</span><span class="n">track_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">track_id</span> <span class="ow">in</span> <span class="n">playlist_tracks</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Produces a string representation of this playlist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist represented as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this playlist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Playlist represented as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Eventual repr string to return.</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">(</span><span class="si">{}{}</span><span class="s2">)&quot;</span>
    <span class="c1"># Body of the repr string to fill out with playlist contents.</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="c1"># Get the repr recursion depth to determine the degree of indentation.</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">frame</span>
                <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">frame</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;__repr__&quot;</span>
                <span class="ow">and</span> <span class="n">Path</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;rekordbox_playlist.py&quot;</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="o">-</span> <span class="mi">1</span>
    <span class="p">)</span>
    <span class="c1"># These variables are used to control indentation level.</span>
    <span class="n">extra</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">depth</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">padding</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extra</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Dunder members aren&#39;t represented. Public members (i.e. methods)</span>
    <span class="c1"># aren&#39;t represented either.</span>
    <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_parent&quot;</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_aggregate&quot;</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Build a representation of this playlist.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Skip representing this playlist&#39;s tracks.</span>
        <span class="c1"># Defer representation of the playlists attribute until the end.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="c1"># Represent string values with surrounding double quotes.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, &quot;</span>

    <span class="c1"># Truncate the final attributes trailing &quot;, &quot;.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">]:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Now represent the playlist attribute as an indented list of</span>
    <span class="c1"># sub-playlists.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;playlists&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}{</span><span class="n">key</span><span class="si">}</span><span class="s2">=[&quot;</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">depth</span><span class="si">}{</span><span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">,&quot;</span>
        <span class="c1"># Truncate final comma.</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">],&quot;</span>

    <span class="c1"># Truncate final comma.</span>
    <span class="k">if</span> <span class="n">repr_attrs</span><span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">]:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">padding</span> <span class="k">if</span> <span class="n">depth</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">body</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">padding</span><span class="si">}{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">depth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlists</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Produce a string representation of this playlist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist represented as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produce a string representation of this playlist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Playlist represented as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.get_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_name</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns the name of this playlist.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the name of this playlist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Name</span>  <span class="c1"># pylint: disable=no-member</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.is_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_folder</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns whether this playlist is a folder or a playlist of tracks.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean representing whether this is a folder or not.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether this playlist is a folder or a playlist of tracks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Boolean representing whether this is a folder or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Type</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span>  <span class="c1"># pylint: disable=no-member</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.new_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">new_playlist</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">playlists</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enable_aggregation</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Creates a new playlist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the Playlist to be created.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlists</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="RekordboxPlaylist (djtools.collection.rekordbox_playlist.RekordboxPlaylist)" href="#djtools.collection.RekordboxPlaylist">RekordboxPlaylist</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of Playlists to add to this Playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="RekordboxTrack (djtools.collection.rekordbox_track.RekordboxTrack)" href="#djtools.collection.RekordboxTrack">RekordboxTrack</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict of Tracks to add to this Playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>enable_aggregation</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this playlist has an aggregation
playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>You must provide either a list of Playlists or a list
of Tracks.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>You must not provide both a list of Playlists and a
list of Tracks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="RekordboxPlaylist (djtools.collection.rekordbox_playlist.RekordboxPlaylist)" href="#djtools.collection.RekordboxPlaylist">RekordboxPlaylist</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">new_playlist</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">playlists</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RekordboxTrack</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">enable_aggregation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;RekordboxPlaylist&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new playlist.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the Playlist to be created.</span>
<span class="sd">        playlists: A list of Playlists to add to this Playlist.</span>
<span class="sd">        tracks: A dict of Tracks to add to this Playlist.</span>
<span class="sd">        enable_aggregation: Whether or not this playlist has an aggregation</span>
<span class="sd">            playlist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: You must provide either a list of Playlists or a list</span>
<span class="sd">            of Tracks.</span>
<span class="sd">        RuntimeError: You must not provide both a list of Playlists and a</span>
<span class="sd">            list of Tracks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;You must provide either a list of RekordboxPlaylists or a &quot;</span>
            <span class="s2">&quot;list of RekordboxTracks&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">tracks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;You must not provide both a list of RekordboxPlaylists and a &quot;</span>
            <span class="s2">&quot;list of RekordboxTracks&quot;</span>
        <span class="p">)</span>
    <span class="n">playlist_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">playlists</span><span class="p">)}</span>
            <span class="k">if</span> <span class="n">playlists</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;KeyType&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Entries&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">playlist</span> <span class="o">=</span> <span class="n">RekordboxPlaylist</span><span class="p">(</span>
        <span class="n">playlist_tag</span><span class="p">,</span>
        <span class="n">tracks</span><span class="o">=</span><span class="n">tracks</span><span class="p">,</span>
        <span class="n">playlist_tracks</span><span class="o">=</span><span class="p">(</span><span class="n">tracks</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
        <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">playlist</span><span class="o">.</span><span class="n">_playlists</span> <span class="o">=</span> <span class="n">playlists</span>

    <span class="k">return</span> <span class="n">playlist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxPlaylist.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Serializes this playlist as a BeautifulSoup NODE Tag.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bs4.element.Tag">Tag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BeautifulSoup Tag representing this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_playlist.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serializes this playlist as a BeautifulSoup NODE Tag.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BeautifulSoup Tag representing this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># BeautifulSoup Tag to populate with attributes of this playlist.</span>
    <span class="n">playlist_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;NODE&quot;</span><span class="p">,</span> <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Dunder members aren&#39;t serialized. Public members (i.e. methods)</span>
    <span class="c1"># aren&#39;t serialized either.</span>
    <span class="n">serialize_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_parent&quot;</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;_aggregate&quot;</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Serialize attributes into a NODE Tag.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">serialize_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Playlists and tracks are serialized as nested Tag objects.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;playlists&quot;</span><span class="p">,</span> <span class="s2">&quot;tracks&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Iterate and serialize nested playlists.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">playlist_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">val</span><span class="o">.</span><span class="n">serialize</span><span class="p">()]</span>
                    <span class="p">)</span>
            <span class="c1"># Iterate and serialize tracks.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">playlist_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span>
                            <span class="n">val</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">playlist</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                        <span class="p">]</span>
                    <span class="p">)</span>

            <span class="c1"># Append a final newline character.</span>
            <span class="n">playlist_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="k">continue</span>

        <span class="c1"># Otherwise the data is serialized as NODE Tag attributes.</span>
        <span class="n">playlist_tag</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Update the Count or Entries attribute.</span>
    <span class="n">playlist_tag</span><span class="p">[</span><span class="s2">&quot;Count&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_folder</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;Entries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">playlist_tag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.RekordboxTrack" class="doc doc-heading">
            <code>RekordboxTrack</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="djtools.collection.base_track.Track">Track</span></code></p>


        <p>Track implementation for usage with Rekordbox.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RekordboxTrack</span><span class="p">(</span><span class="n">Track</span><span class="p">):</span>
    <span class="s2">&quot;Track implementation for usage with Rekordbox.&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deserialize a track from a BeautifulSoup TRACK Tag.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: BeautifulSoup Tag representing a track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Prefix of the path to the audio file corresponding to this track.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;file://localhost&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;file://localhost/&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Set class attributes from TRACK Tag attributes.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;BitRate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;DiscNumber&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PlayCount&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SampleRate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Size&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TotalTime&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TrackNumber&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;AverageBpm&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;DateAdded&quot;</span><span class="p">:</span>
                <span class="c1"># We need to keep the original date added string because</span>
                <span class="c1"># Rekordbox doesn&#39;t format date strings consistently i.e.</span>
                <span class="c1"># ensuring perfect serialization symmetry is not possible</span>
                <span class="c1"># without this.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Genre&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Location&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">unquote</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Rating&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;51&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;102&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;153&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="s2">&quot;204&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="s2">&quot;255&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Parse MyTag data from Comments attribute.</span>
        <span class="n">my_tags</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?&lt;=\/\*).*(?=\*\/)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Comments</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MyTags</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=invalid-name</span>
            <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_tags</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">my_tags</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>

        <span class="c1"># Merge Genre and MyTag data into a new attribute.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Genre</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MyTags</span>  <span class="c1"># pylint: disable=invalid-name</span>

        <span class="c1"># Parse TEMPO Tags as the beat grid attribute.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;TEMPO&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span><span class="p">]</span>

        <span class="c1"># Parse POSITION_MARK Tags as the hot cues attribute.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;POSITION_MARK&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">hot_cue</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">hot_cue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Track represented as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Enforce a maximum width for a Track representation.</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="mi">79</span>
        <span class="c1"># Eventual repr string to return.</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">)&quot;</span>
        <span class="c1"># Body of the repr string to fill out with track contents.</span>
        <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span>

        <span class="c1"># Dunder members aren&#39;t represented. Public members (i.e. methods)</span>
        <span class="c1"># aren&#39;t represented either.</span>
        <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Build a representation of this track.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Prettify output by enforcing `max_width`.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
                <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="c1"># Rather than display each beat grid or hot cue attribute, simply</span>
            <span class="c1"># represent as the number of those attributes.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;beat_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;hot_cues&quot;</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Represent string values with surrounding double quotes.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

            <span class="c1"># Truncate the HH:MM:SS part of the datetime.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

            <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, &quot;</span>

        <span class="c1"># Truncate final comma and space.</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Track represented as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track artists.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representing the track&#39;s artists.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Artist</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bpm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track BPM.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A float representing BPM.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AverageBpm</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track comments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representing the track&#39;s comments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Comments</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_date_added</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track&#39;s date added.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A datetime representing the track&#39;s date added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DateAdded</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_genre_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the genre tags of the track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of the track&#39;s genre tags.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Genre</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the track ID.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The ID of this track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TrackID</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track key.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The key of this track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tonality</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the track label.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The label of this track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Label</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_location</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the location of the track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The Path for the location of the track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Location</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the rating of the track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The rating of the track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Rating</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the tags of the track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A set of the track&#39;s tags.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tags</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the year of the track.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The year of the track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Year</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Serializes this track as a BeautifulSoup TRACK Tag.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Whether or not to serialize this track as a member of a</span>
<span class="sd">                playlist.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: The DateAdded attribute must serialize into its</span>
<span class="sd">                original format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BeautifulSoup Tag representing this track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># BeautifulSoup Tag to populate with attributes of this track.</span>
        <span class="n">track_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TRACK&quot;</span><span class="p">,</span> <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># TRACK Tags in playlists are serialized differently from top-level</span>
        <span class="c1"># TRACK Tags.</span>
        <span class="k">if</span> <span class="n">playlist</span><span class="p">:</span>
            <span class="n">track_tag</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">track_tag</span>

        <span class="c1"># Dunder members aren&#39;t serialized. Public members (i.e. methods)</span>
        <span class="c1"># aren&#39;t serialized either.</span>
        <span class="n">serialize_attrs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;_MyTags&quot;</span><span class="p">,</span> <span class="s2">&quot;_Tags&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">}</span>

        <span class="c1"># Serialize attributes into a TRACK Tag.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">serialize_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Beat grid and hot cue data is serialized as TEMPO and</span>
            <span class="c1"># POSITION_MARK Tags, respectively.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;beat_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;hot_cues&quot;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;POSITION_MARK&quot;</span> <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;hot_cues&quot;</span> <span class="k">else</span> <span class="s2">&quot;TEMPO&quot;</span><span class="p">,</span>
                        <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">tag</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="n">track_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">tag</span><span class="p">])</span>
                <span class="k">continue</span>

            <span class="c1"># Cast integers back into a string.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;BitRate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;DiscNumber&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PlayCount&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SampleRate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Size&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TotalTime&quot;</span><span class="p">,</span>
                <span class="s2">&quot;TrackNumber&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Increase BPM precision to make serialization 100% symmetrical.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;AverageBpm&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">0,.2f</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="c1"># Truncate the HH:MM:SS part of the datetime.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
                <span class="c1"># Rekordbox doesn&#39;t consistently format dates with or without</span>
                <span class="c1"># leading zeros on the month and day portion of the date</span>
                <span class="c1"># string, so we have to try all three of these formats to see</span>
                <span class="c1"># if the resulting formatting matches the original one.</span>
                <span class="n">date_formats</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">(</span><span class="s2">&quot;%Y-%-m-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;%Y-%#m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s2">&quot;%Y-%-m-</span><span class="si">%-d</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;%Y-%#m-</span><span class="si">%#d</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="k">for</span> <span class="n">date_format</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>
                    <span class="n">attempt</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">attempt</span>

                <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
                        <span class="sa">f</span><span class="s2">&quot;Failed to serialize the datetime </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> into its &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;original format </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

            <span class="c1"># Re-join genre tags with forward slashes.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Genre&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot; / &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Re-insert the location prefix and quote the path.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Location&quot;</span><span class="p">:</span>
                <span class="n">track_path</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">safe</span><span class="o">=</span><span class="s2">&quot;/,()!+=#;$:&quot;</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span><span class="si">}{</span><span class="n">track_path</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;%[0-9A-Z]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span>
                <span class="p">)</span>

            <span class="c1"># Reverse the rating value to the range recognized by Rekordbox.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Rating&quot;</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;51&quot;</span><span class="p">,</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;102&quot;</span><span class="p">,</span>
                    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;153&quot;</span><span class="p">,</span>
                    <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;204&quot;</span><span class="p">,</span>
                    <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;255&quot;</span><span class="p">,</span>
                <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Otherwise the data is serialized as TRACK Tag attributes.</span>
            <span class="n">track_tag</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># If this TRACK Tag has children, append a final newline character.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">track_tag</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">track_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">track_tag</span>

    <span class="nd">@make_path</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the path of the track to location.</span>

<span class="sd">        Args:</span>
<span class="sd">            location: New location of the track.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Location</span> <span class="o">=</span> <span class="n">location</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init,invalid-name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_track_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the track number of a track.</span>

<span class="sd">        Args:</span>
<span class="sd">            number: Number to set for TrackNumber.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_TrackNumber</span> <span class="o">=</span> <span class="n">number</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init,invalid-name</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Deserialize a track from a BeautifulSoup TRACK Tag.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="bs4.element.Tag">Tag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BeautifulSoup Tag representing a track.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deserialize a track from a BeautifulSoup TRACK Tag.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: BeautifulSoup Tag representing a track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prefix of the path to the audio file corresponding to this track.</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;file://localhost&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;file://localhost/&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Set class attributes from TRACK Tag attributes.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;BitRate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DiscNumber&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PlayCount&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SampleRate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Size&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TotalTime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TrackNumber&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;AverageBpm&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;DateAdded&quot;</span><span class="p">:</span>
            <span class="c1"># We need to keep the original date added string because</span>
            <span class="c1"># Rekordbox doesn&#39;t format date strings consistently i.e.</span>
            <span class="c1"># ensuring perfect serialization symmetry is not possible</span>
            <span class="c1"># without this.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Genre&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Location&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">unquote</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Rating&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;51&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;102&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;153&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s2">&quot;204&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="s2">&quot;255&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Parse MyTag data from Comments attribute.</span>
    <span class="n">my_tags</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?&lt;=\/\*).*(?=\*\/)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Comments</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_MyTags</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=invalid-name</span>
        <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_tags</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)]</span> <span class="k">if</span> <span class="n">my_tags</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="p">)</span>

    <span class="c1"># Merge Genre and MyTag data into a new attribute.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_Tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Genre</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MyTags</span>  <span class="c1"># pylint: disable=invalid-name</span>

    <span class="c1"># Parse TEMPO Tags as the beat grid attribute.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;TEMPO&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">point</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beat_grid</span><span class="p">]</span>

    <span class="c1"># Parse POSITION_MARK Tags as the hot cues attribute.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;POSITION_MARK&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">hot_cue</span><span class="o">.</span><span class="n">attrs</span> <span class="k">for</span> <span class="n">hot_cue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hot_cues</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.__repr__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Produces a string representation of this track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track represented as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Track represented as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Enforce a maximum width for a Track representation.</span>
    <span class="n">max_width</span> <span class="o">=</span> <span class="mi">79</span>
    <span class="c1"># Eventual repr string to return.</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">)&quot;</span>
    <span class="c1"># Body of the repr string to fill out with track contents.</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span>

    <span class="c1"># Dunder members aren&#39;t represented. Public members (i.e. methods)</span>
    <span class="c1"># aren&#39;t represented either.</span>
    <span class="n">repr_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Build a representation of this track.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">repr_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Prettify output by enforcing `max_width`.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">body</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=-</span><span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Rather than display each beat grid or hot cue attribute, simply</span>
        <span class="c1"># represent as the number of those attributes.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;beat_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;hot_cues&quot;</span><span class="p">]:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Represent string values with surrounding double quotes.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="c1"># Truncate the HH:MM:SS part of the datetime.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="c1"># Append the attribute&#39;s name and value to the representation.</span>
        <span class="n">body</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">, &quot;</span>

    <span class="c1"># Truncate final comma and space.</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.__str__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Produces a string representation of this track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track represented as a string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Produces a string representation of this track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Track represented as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serialize</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_artists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_artists</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track artists.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the track's artists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track artists.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representing the track&#39;s artists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Artist</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_bpm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_bpm</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track BPM.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A float representing BPM.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_bpm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track BPM.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A float representing BPM.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AverageBpm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_comments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_comments</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track comments.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string representing the track's comments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_comments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track comments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representing the track&#39;s comments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Comments</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_date_added" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_date_added</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track's date added.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A datetime representing the track's date added.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_date_added</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track&#39;s date added.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A datetime representing the track&#39;s date added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DateAdded</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_genre_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_genre_tags</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the genre tags of the track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of the track's genre tags.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_genre_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the genre tags of the track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of the track&#39;s genre tags.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Genre</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_id</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get the track ID.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of this track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the track ID.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The ID of this track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TrackID</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_key</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track key.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key of this track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track key.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The key of this track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tonality</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_label" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_label</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the track label.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of this track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the track label.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The label of this track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Label</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_location</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the location of the track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Path for the location of the track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_location</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the location of the track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Path for the location of the track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Location</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_rating" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_rating</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the rating of the track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The rating of the track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the rating of the track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The rating of the track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Rating</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tags</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the tags of the track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of the track's tags.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the tags of the track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A set of the track&#39;s tags.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.get_year" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_year</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the year of the track.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The year of the track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_year</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the year of the track.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The year of the track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Year</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.serialize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">serialize</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">playlist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Serializes this track as a BeautifulSoup TRACK Tag.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to serialize this track as a member of a
playlist.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DateAdded attribute must serialize into its
original format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bs4.element.Tag">Tag</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BeautifulSoup Tag representing this track.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">serialize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Serializes this track as a BeautifulSoup TRACK Tag.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Whether or not to serialize this track as a member of a</span>
<span class="sd">            playlist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The DateAdded attribute must serialize into its</span>
<span class="sd">            original format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BeautifulSoup Tag representing this track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># BeautifulSoup Tag to populate with attributes of this track.</span>
    <span class="n">track_tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;TRACK&quot;</span><span class="p">,</span> <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># TRACK Tags in playlists are serialized differently from top-level</span>
    <span class="c1"># TRACK Tags.</span>
    <span class="k">if</span> <span class="n">playlist</span><span class="p">:</span>
        <span class="n">track_tag</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">track_tag</span>

    <span class="c1"># Dunder members aren&#39;t serialized. Public members (i.e. methods)</span>
    <span class="c1"># aren&#39;t serialized either.</span>
    <span class="n">serialize_attrs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;_MyTags&quot;</span><span class="p">,</span> <span class="s2">&quot;_Tags&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Serialize attributes into a TRACK Tag.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">serialize_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Beat grid and hot cue data is serialized as TEMPO and</span>
        <span class="c1"># POSITION_MARK Tags, respectively.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;beat_grid&quot;</span><span class="p">,</span> <span class="s2">&quot;hot_cues&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">tag</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">Tag</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;POSITION_MARK&quot;</span> <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;hot_cues&quot;</span> <span class="k">else</span> <span class="s2">&quot;TEMPO&quot;</span><span class="p">,</span>
                    <span class="n">can_be_empty_element</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">tag</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">val</span>
                <span class="n">track_tag</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">tag</span><span class="p">])</span>
            <span class="k">continue</span>

        <span class="c1"># Cast integers back into a string.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;BitRate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DiscNumber&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PlayCount&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SampleRate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Size&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TotalTime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TrackNumber&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Increase BPM precision to make serialization 100% symmetrical.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;AverageBpm&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">0,.2f</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Truncate the HH:MM:SS part of the datetime.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
            <span class="c1"># Rekordbox doesn&#39;t consistently format dates with or without</span>
            <span class="c1"># leading zeros on the month and day portion of the date</span>
            <span class="c1"># string, so we have to try all three of these formats to see</span>
            <span class="c1"># if the resulting formatting matches the original one.</span>
            <span class="n">date_formats</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">(</span><span class="s2">&quot;%Y-%-m-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;%Y-%#m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;%Y-%-m-</span><span class="si">%-d</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;posix&quot;</span> <span class="k">else</span> <span class="s2">&quot;%Y-%#m-</span><span class="si">%#d</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">date_format</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>
                <span class="n">attempt</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attempt</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">attempt</span>

            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>  <span class="c1"># pragma: no cover</span>
                    <span class="sa">f</span><span class="s2">&quot;Failed to serialize the datetime </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> into its &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;original format </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__original_date_added</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Re-join genre tags with forward slashes.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Genre&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot; / &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Re-insert the location prefix and quote the path.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Location&quot;</span><span class="p">:</span>
            <span class="n">track_path</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">safe</span><span class="o">=</span><span class="s2">&quot;/,()!+=#;$:&quot;</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__location_prefix</span><span class="si">}{</span><span class="n">track_path</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;%[0-9A-Z]</span><span class="si">{2}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">value</span>
            <span class="p">)</span>

        <span class="c1"># Reverse the rating value to the range recognized by Rekordbox.</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;Rating&quot;</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;51&quot;</span><span class="p">,</span>
                <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;102&quot;</span><span class="p">,</span>
                <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;153&quot;</span><span class="p">,</span>
                <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;204&quot;</span><span class="p">,</span>
                <span class="mi">5</span><span class="p">:</span> <span class="s2">&quot;255&quot;</span><span class="p">,</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c1"># Otherwise the data is serialized as TRACK Tag attributes.</span>
        <span class="n">track_tag</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># If this TRACK Tag has children, append a final newline character.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">track_tag</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">track_tag</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bs4</span><span class="o">.</span><span class="n">NavigableString</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">track_tag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.set_location" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_location</span><span class="p">(</span><span class="n">location</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sets the path of the track to location.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>location</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New location of the track.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the path of the track to location.</span>

<span class="sd">    Args:</span>
<span class="sd">        location: New location of the track.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_Location</span> <span class="o">=</span> <span class="n">location</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init,invalid-name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.RekordboxTrack.set_track_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_track_number</span><span class="p">(</span><span class="n">number</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sets the track number of a track.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>number</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number to set for TrackNumber.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/rekordbox_track.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_track_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the track number of a track.</span>

<span class="sd">    Args:</span>
<span class="sd">        number: Number to set for TrackNumber.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_TrackNumber</span> <span class="o">=</span> <span class="n">number</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init,invalid-name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="djtools.collection.collection_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collection_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Builds playlists automatically.</p>
<p>By maintaining a collection with tracks having tag data (e.g. genre tags,
Rekordbox's "My Tags", etc.) and providing a playlist config which
specifies a desired playlist structure based around these tags, users can
automatically generate that playlist structure.</p>
<p>The playlist config is a YAML file which specifies a nested structure of
folders. Each folder is declared with a "name" and a list of "playlists"
which may be either more folder declarations or else strings matching a tag
in your collection.</p>
<p>Any folder that has more than one playlist within it will automatically
have an "All <folder name>" playlist added to it that contains the set of
tracks from all the other playlists in that folder.</p>
<p>Any tag in your collection that is not specified in the playlist config
will automatically be added to either an "Other" folder of playlists or an
"Other" playlist (depending on your configured choice for
collection_playlists_remainder).</p>
<p>A special folder with the name "_ignore" may be included anywhere within
the "tags" specification with playlists matching the set of tags to ignore
when creating the "Other" folder / playlist.</p>
<p>In addition to creating playlists from tags, this function also supports
creating "combiner" playlists by evaluating boolean algebra expressions.
This is an incredibly powerful feature which allows users to apply set
operations {union, intersection, and difference} to a diverse range of
operands {tag, playlists, BPMs, ratings, etc.}.</p>
<p>Combiner playlists are declared in the "combiner" specification of the
playlist config with playlists whose names are the boolean algebra
expressions used to construct them.</p>
<p>Here's an example combiner playlist to illustrate this:</p>
<pre><code>((Dubstep ~ [1-3]) | {playlist: My Favorites} | (*Techno &amp; [135-145])) &amp; Dark
</code></pre>
<p>The resulting combiner playlist will be comprised of tracks that are:</p>
<ul>
<li>tagged as "Dubstep" but NOT having a rating less than 4</li>
<li>OR in the playlist called "My Favorites"</li>
<li>OR tagged as something ending with "Techno" AND in the BPM range of 135
to 145</li>
<li>AND tagged as "Dark"</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.collection.playlist_builder.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to write the new collection to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">collection_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds playlists automatically.</span>

<span class="sd">    By maintaining a collection with tracks having tag data (e.g. genre tags,</span>
<span class="sd">    Rekordbox&#39;s &quot;My Tags&quot;, etc.) and providing a playlist config which</span>
<span class="sd">    specifies a desired playlist structure based around these tags, users can</span>
<span class="sd">    automatically generate that playlist structure.</span>

<span class="sd">    The playlist config is a YAML file which specifies a nested structure of</span>
<span class="sd">    folders. Each folder is declared with a &quot;name&quot; and a list of &quot;playlists&quot;</span>
<span class="sd">    which may be either more folder declarations or else strings matching a tag</span>
<span class="sd">    in your collection.</span>

<span class="sd">    Any folder that has more than one playlist within it will automatically</span>
<span class="sd">    have an &quot;All &lt;folder name&gt;&quot; playlist added to it that contains the set of</span>
<span class="sd">    tracks from all the other playlists in that folder.</span>

<span class="sd">    Any tag in your collection that is not specified in the playlist config</span>
<span class="sd">    will automatically be added to either an &quot;Other&quot; folder of playlists or an</span>
<span class="sd">    &quot;Other&quot; playlist (depending on your configured choice for</span>
<span class="sd">    collection_playlists_remainder).</span>

<span class="sd">    A special folder with the name &quot;_ignore&quot; may be included anywhere within</span>
<span class="sd">    the &quot;tags&quot; specification with playlists matching the set of tags to ignore</span>
<span class="sd">    when creating the &quot;Other&quot; folder / playlist.</span>

<span class="sd">    In addition to creating playlists from tags, this function also supports</span>
<span class="sd">    creating &quot;combiner&quot; playlists by evaluating boolean algebra expressions.</span>
<span class="sd">    This is an incredibly powerful feature which allows users to apply set</span>
<span class="sd">    operations {union, intersection, and difference} to a diverse range of</span>
<span class="sd">    operands {tag, playlists, BPMs, ratings, etc.}.</span>

<span class="sd">    Combiner playlists are declared in the &quot;combiner&quot; specification of the</span>
<span class="sd">    playlist config with playlists whose names are the boolean algebra</span>
<span class="sd">    expressions used to construct them.</span>

<span class="sd">    Here&#39;s an example combiner playlist to illustrate this:</span>

<span class="sd">        ((Dubstep ~ [1-3]) | {playlist: My Favorites} | (*Techno &amp; [135-145])) &amp; Dark</span>

<span class="sd">    The resulting combiner playlist will be comprised of tracks that are:</span>

<span class="sd">    - tagged as &quot;Dubstep&quot; but NOT having a rating less than 4</span>
<span class="sd">    - OR in the playlist called &quot;My Favorites&quot;</span>
<span class="sd">    - OR tagged as something ending with &quot;Techno&quot; AND in the BPM range of 135</span>
<span class="sd">    to 145</span>
<span class="sd">    - AND tagged as &quot;Dark&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        path: Path to write the new collection to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the playlist config is populated before continuing.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span>
        <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Not building playlists because the playlist config is empty.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Load the collection.</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;collection&quot;</span><span class="p">](</span>
        <span class="n">path</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_path</span>
    <span class="p">)</span>

    <span class="c1"># Get the Playlist implementation to use for this collection.</span>
    <span class="n">playlist_class</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;playlist&quot;</span><span class="p">]</span>

    <span class="c1"># Required number of tracks to make tag and combiner playlists.</span>
    <span class="n">minimum_tag_tracks</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">minimum_tag_playlist_tracks</span>
    <span class="n">minimum_combiner_tracks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">minimum_combiner_playlist_tracks</span>
    <span class="p">)</span>

    <span class="c1"># Create a dict of tracks keyed by their individual tags.</span>
    <span class="n">tags_tracks</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_tags</span><span class="p">():</span>
            <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>

    <span class="c1"># This will hold the playlists being built.</span>
    <span class="n">auto_playlists</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># List of PlaylistFilter implementations to run against built playlists.</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">playlist_filters</span><span class="p">,</span> <span class="n">playlist_filter</span><span class="o">.</span><span class="n">value</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">playlist_filter</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_playlist_filters</span>
    <span class="p">]</span>

    <span class="c1"># Create playlists for the &quot;tags&quot; portion of the playlist config.</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="c1"># A set of tags seen is maintained while creating the tags playlists so</span>
        <span class="c1"># that they are ignored when creating the &quot;Other&quot; playlists.</span>
        <span class="n">seen_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">tag_playlists</span> <span class="o">=</span> <span class="n">build_tag_playlists</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">playlist_class</span><span class="p">,</span>
            <span class="n">seen_tags</span><span class="p">,</span>
            <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The tag playlists must have their &quot;parent&quot; attribute set so that</span>
        <span class="c1"># PlaylistFilter implementations may apply logic that depends on the</span>
        <span class="c1"># relative position of the playlist with the playlist tree.</span>
        <span class="n">tag_playlists</span><span class="o">.</span><span class="n">set_parent</span><span class="p">()</span>

        <span class="c1"># Apply the filtering logic of the configured PlaylistFilter implementations.</span>
        <span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">tag_playlists</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>

        <span class="c1"># Recursively traverse the playlist tree and create &quot;all&quot; playlists</span>
        <span class="c1"># within each folder containing more than one playlist. These &quot;all&quot;</span>
        <span class="c1"># playlists aggregate the set of tracks contained within all the other</span>
        <span class="c1"># playlists within the same folder.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">aggregate_playlists</span><span class="p">(</span>
            <span class="n">tag_playlists</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_tag_tracks</span>
        <span class="p">)</span>

        <span class="n">auto_playlists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tag_playlists</span><span class="p">)</span>

        <span class="c1"># Identify the set of tags that did not appear in the playlist config</span>
        <span class="c1"># and create either an &quot;Other&quot; folder of playlists or simply an &quot;Other&quot;</span>
        <span class="c1"># playlist.</span>
        <span class="n">other_tags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tags_tracks</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">seen_tags</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_playlists_remainder</span>
            <span class="o">==</span> <span class="n">PlaylistRemainder</span><span class="o">.</span><span class="n">FOLDER</span>
        <span class="p">):</span>
            <span class="n">auto_playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">build_tag_playlists</span><span class="p">(</span>
                    <span class="n">PlaylistConfigContent</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unused Tags&quot;</span><span class="p">,</span> <span class="n">playlists</span><span class="o">=</span><span class="n">other_tags</span>
                    <span class="p">),</span>
                    <span class="n">tags_tracks</span><span class="p">,</span>
                    <span class="n">playlist_class</span><span class="p">,</span>
                    <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">auto_playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">build_tag_playlists</span><span class="p">(</span>
                    <span class="s2">&quot;Unused Tags&quot;</span><span class="p">,</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Unused Tags&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
                            <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">track_dict</span> <span class="ow">in</span> <span class="n">tags_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                            <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                            <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">other_tags</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="n">playlist_class</span><span class="p">,</span>
                    <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Create playlists for the &quot;combiner&quot; portion of the playlist config.</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">:</span>
        <span class="c1"># Parse selectors from the combiner playlist names and update the</span>
        <span class="c1"># tags_tracks mapping.</span>
        <span class="n">add_selectors_to_tags</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">collection</span><span class="p">,</span>
            <span class="n">auto_playlists</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Evaluate the boolean logic of the combiner playlists.</span>
        <span class="n">combiner_playlists</span> <span class="o">=</span> <span class="n">build_combiner_playlists</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">playlist_class</span><span class="p">,</span>
            <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_combiner_tracks</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The tag playlists must have their &quot;parent&quot; attribute set so that</span>
        <span class="c1"># PlaylistFilter implementations may apply logic that depends on the</span>
        <span class="c1"># relative position of the playlist with the playlist tree.</span>
        <span class="n">combiner_playlists</span><span class="o">.</span><span class="n">set_parent</span><span class="p">()</span>

        <span class="c1"># Apply the filtering logic of the configured PlaylistFilter implementations.</span>
        <span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>

        <span class="c1"># Recursively traverse the playlist tree and create &quot;all&quot; playlists</span>
        <span class="c1"># within each folder containing more than one playlist. These &quot;all&quot;</span>
        <span class="c1"># playlists aggregate the set of tracks contained within all the other</span>
        <span class="c1"># playlists within the same folder.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">aggregate_playlists</span><span class="p">(</span>
            <span class="n">combiner_playlists</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_combiner_tracks</span>
        <span class="p">)</span>

        <span class="n">auto_playlists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">)</span>

        <span class="c1"># Print tag statistics for each combiner playlist.</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbosity</span> <span class="ow">and</span> <span class="n">combiner_playlists</span><span class="p">:</span>
            <span class="n">print_playlists_tag_statistics</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">)</span>

    <span class="c1"># Remove any previous playlist builder playlists.</span>
    <span class="n">previous_playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">PLAYLIST_NAME</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">previous_playlists</span><span class="p">:</span>
        <span class="n">root</span><span class="o">.</span><span class="n">remove_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span>

    <span class="c1"># Insert a new playlist containing the built playlists.</span>
    <span class="n">auto_playlist</span> <span class="o">=</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">PLAYLIST_NAME</span><span class="p">,</span> <span class="n">playlists</span><span class="o">=</span><span class="n">auto_playlists</span>
    <span class="p">)</span>
    <span class="n">auto_playlist</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">())</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">add_playlist</span><span class="p">(</span><span class="n">auto_playlist</span><span class="p">)</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

    <span class="n">num_playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">()</span><span class="o">.</span><span class="n">get_number_of_playlists</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PLAYLIST_NAME</span><span class="si">}</span><span class="s2"> generated with </span><span class="si">{</span><span class="n">num_playlists</span><span class="si">}</span><span class="s2"> playlists&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.config"></a>
    <div class="doc doc-contents first">

        <p>This module contains the configuration objects for the collection package.
The attributes of this configuration object correspond with the "collection"
key of config.yaml</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.CollectionConfig" class="doc doc-heading">
            <code>CollectionConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="djtools.configs.config_formatter.BaseConfigFormatter">BaseConfigFormatter</span></code></p>


        <p>Configuration object for the collection package.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CollectionConfig</span><span class="p">(</span><span class="n">BaseConfigFormatter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration object for the collection package.&quot;&quot;&quot;</span>

    <span class="n">collection_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">collection_playlist_filters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PlaylistFilters</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">collection_playlists</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">collection_playlists_remainder</span><span class="p">:</span> <span class="n">PlaylistRemainder</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">PlaylistRemainder</span><span class="o">.</span><span class="n">FOLDER</span>
    <span class="p">)</span>
    <span class="n">copy_playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">copy_playlists_destination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">minimum_combiner_playlist_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">minimum_tag_playlist_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PositiveInt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">platform</span><span class="p">:</span> <span class="n">RegisteredPlatforms</span> <span class="o">=</span> <span class="n">RegisteredPlatforms</span><span class="o">.</span><span class="n">REKORDBOX</span>
    <span class="n">shuffle_playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">playlist_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PlaylistConfig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: Using the collection package requires a valid</span>
<span class="sd">                collection_path.</span>
<span class="sd">            RuntimeError: Failed to render collection_playlist.yaml from</span>
<span class="sd">                template.</span>
<span class="sd">            RuntimeError: collection_path must be a valid collection path.</span>
<span class="sd">            RuntimeError: collection_playlists.yaml must be a valid YAML file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">collection_playlists</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">copy_playlists</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_playlists</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Using the collection package requires the config option &quot;</span>
                <span class="s2">&quot;collection_path to be a valid collection path&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_playlists</span><span class="p">:</span>
            <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;configs&quot;</span>
            <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span>
                <span class="n">loader</span><span class="o">=</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">config_path</span> <span class="o">/</span> <span class="s2">&quot;playlist_templates&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">playlist_template</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">playlist_template_name</span> <span class="o">=</span> <span class="s2">&quot;collection_playlists.j2&quot;</span>
            <span class="n">playlist_config_path</span> <span class="o">=</span> <span class="n">config_path</span> <span class="o">/</span> <span class="s2">&quot;collection_playlists.yaml&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">playlist_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">playlist_template_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">TemplateNotFound</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">playlist_template</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">playlist_config</span> <span class="o">=</span> <span class="n">playlist_template</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Failed to render </span><span class="si">{</span><span class="n">playlist_template_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

                <span class="k">if</span> <span class="n">playlist_config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Both </span><span class="si">{</span><span class="n">playlist_template_name</span><span class="si">}</span><span class="s2"> and &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_config_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> exist. Overwriting &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_config_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> with the rendered &quot;</span>
                        <span class="s2">&quot;template&quot;</span>
                    <span class="p">)</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                    <span class="n">playlist_config_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
                    <span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">playlist_config</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;collection_playlists.yaml must exist to use the &quot;</span>
                    <span class="s2">&quot;collection_playlists feature&quot;</span>
                <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                    <span class="n">playlist_config_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
                <span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playlist_config</span> <span class="o">=</span> <span class="n">PlaylistConfig</span><span class="p">(</span>
                        <span class="o">**</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
                    <span class="p">)</span>
            <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;collection_playlists.yaml must be a valid YAML to use &quot;</span>
                    <span class="s2">&quot;the collection_playlists feature&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.config.CollectionConfig.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Using the collection package requires a valid
collection_path.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Failed to render collection_playlist.yaml from
template.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>collection_path must be a valid collection path.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>collection_playlists.yaml must be a valid YAML file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: Using the collection package requires a valid</span>
<span class="sd">            collection_path.</span>
<span class="sd">        RuntimeError: Failed to render collection_playlist.yaml from</span>
<span class="sd">            template.</span>
<span class="sd">        RuntimeError: collection_path must be a valid collection path.</span>
<span class="sd">        RuntimeError: collection_playlists.yaml must be a valid YAML file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collection_playlists</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">copy_playlists</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shuffle_playlists</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Using the collection package requires the config option &quot;</span>
            <span class="s2">&quot;collection_path to be a valid collection path&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">collection_playlists</span><span class="p">:</span>
        <span class="n">config_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;configs&quot;</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">config_path</span> <span class="o">/</span> <span class="s2">&quot;playlist_templates&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">playlist_template</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">playlist_template_name</span> <span class="o">=</span> <span class="s2">&quot;collection_playlists.j2&quot;</span>
        <span class="n">playlist_config_path</span> <span class="o">=</span> <span class="n">config_path</span> <span class="o">/</span> <span class="s2">&quot;collection_playlists.yaml&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">playlist_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">playlist_template_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">TemplateNotFound</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">playlist_template</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">playlist_config</span> <span class="o">=</span> <span class="n">playlist_template</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Failed to render </span><span class="si">{</span><span class="n">playlist_template_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>

            <span class="k">if</span> <span class="n">playlist_config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Both </span><span class="si">{</span><span class="n">playlist_template_name</span><span class="si">}</span><span class="s2"> and &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_config_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> exist. Overwriting &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_config_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> with the rendered &quot;</span>
                    <span class="s2">&quot;template&quot;</span>
                <span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                <span class="n">playlist_config_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
                <span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">playlist_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;collection_playlists.yaml must exist to use the &quot;</span>
                <span class="s2">&quot;collection_playlists feature&quot;</span>
            <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                <span class="n">playlist_config_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>
            <span class="p">)</span> <span class="k">as</span> <span class="n">_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">playlist_config</span> <span class="o">=</span> <span class="n">PlaylistConfig</span><span class="p">(</span>
                    <span class="o">**</span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span> <span class="ow">or</span> <span class="p">{}</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;collection_playlists.yaml must be a valid YAML to use &quot;</span>
                <span class="s2">&quot;the collection_playlists feature&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.PlaylistConfig" class="doc doc-heading">
            <code>PlaylistConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A class for type checking the playlist config YAML.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;forbid&quot;</span><span class="p">):</span>
    <span class="s2">&quot;A class for type checking the playlist config YAML.&quot;</span>

    <span class="n">combiner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlaylistConfigContent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlaylistConfigContent</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.PlaylistConfigContent" class="doc doc-heading">
            <code>PlaylistConfigContent</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A class for type checking the content of the playlist config YAML.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistConfigContent</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;forbid&quot;</span><span class="p">):</span>
    <span class="s2">&quot;A class for type checking the content of the playlist config YAML.&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PlaylistConfigContent&quot;</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="n">enable_aggregation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.PlaylistFilters" class="doc doc-heading">
            <code>PlaylistFilters</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>PlaylistFilters enum.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistFilters</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PlaylistFilters enum.&quot;&quot;&quot;</span>

    <span class="n">COMPLEX_TRACK_FILTER</span> <span class="o">=</span> <span class="s2">&quot;ComplexTrackFilter&quot;</span>
    <span class="n">HIPHOP_FILTER</span> <span class="o">=</span> <span class="s2">&quot;HipHopFilter&quot;</span>
    <span class="n">MINIMAL_DEEP_TECH_FILTER</span> <span class="o">=</span> <span class="s2">&quot;MinimalDeepTechFilter&quot;</span>
    <span class="n">TRANSITION_TRACK_FILTER</span> <span class="o">=</span> <span class="s2">&quot;TransitionTrackFilter&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.PlaylistName" class="doc doc-heading">
            <code>PlaylistName</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>A class for configuring the names of playlists.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistName</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="s2">&quot;forbid&quot;</span><span class="p">):</span>
    <span class="s2">&quot;A class for configuring the names of playlists.&quot;</span>

    <span class="n">tag_content</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.PlaylistRemainder" class="doc doc-heading">
            <code>PlaylistRemainder</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>PlaylistRemainder enum.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistRemainder</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PlaylistRemainder enum.&quot;&quot;&quot;</span>

    <span class="n">FOLDER</span> <span class="o">=</span> <span class="s2">&quot;folder&quot;</span>
    <span class="n">PLAYLIST</span> <span class="o">=</span> <span class="s2">&quot;playlist&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.config.RegisteredPlatforms" class="doc doc-heading">
            <code>RegisteredPlatforms</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>RegisteredPlatforms enum.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RegisteredPlatforms</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;RegisteredPlatforms enum.&quot;&quot;&quot;</span>

    <span class="n">REKORDBOX</span> <span class="o">=</span> <span class="s2">&quot;rekordbox&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.playlist_builder"></a>
    <div class="doc doc-contents first">

        <p>This module is used to automatically generate a playlist structure.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.collection.playlist_builder.collection_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collection_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Builds playlists automatically.</p>
<p>By maintaining a collection with tracks having tag data (e.g. genre tags,
Rekordbox's "My Tags", etc.) and providing a playlist config which
specifies a desired playlist structure based around these tags, users can
automatically generate that playlist structure.</p>
<p>The playlist config is a YAML file which specifies a nested structure of
folders. Each folder is declared with a "name" and a list of "playlists"
which may be either more folder declarations or else strings matching a tag
in your collection.</p>
<p>Any folder that has more than one playlist within it will automatically
have an "All <folder name>" playlist added to it that contains the set of
tracks from all the other playlists in that folder.</p>
<p>Any tag in your collection that is not specified in the playlist config
will automatically be added to either an "Other" folder of playlists or an
"Other" playlist (depending on your configured choice for
collection_playlists_remainder).</p>
<p>A special folder with the name "_ignore" may be included anywhere within
the "tags" specification with playlists matching the set of tags to ignore
when creating the "Other" folder / playlist.</p>
<p>In addition to creating playlists from tags, this function also supports
creating "combiner" playlists by evaluating boolean algebra expressions.
This is an incredibly powerful feature which allows users to apply set
operations {union, intersection, and difference} to a diverse range of
operands {tag, playlists, BPMs, ratings, etc.}.</p>
<p>Combiner playlists are declared in the "combiner" specification of the
playlist config with playlists whose names are the boolean algebra
expressions used to construct them.</p>
<p>Here's an example combiner playlist to illustrate this:</p>
<pre><code>((Dubstep ~ [1-3]) | {playlist: My Favorites} | (*Techno &amp; [135-145])) &amp; Dark
</code></pre>
<p>The resulting combiner playlist will be comprised of tracks that are:</p>
<ul>
<li>tagged as "Dubstep" but NOT having a rating less than 4</li>
<li>OR in the playlist called "My Favorites"</li>
<li>OR tagged as something ending with "Techno" AND in the BPM range of 135
to 145</li>
<li>AND tagged as "Dark"</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.collection.playlist_builder.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to write the new collection to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">collection_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Builds playlists automatically.</span>

<span class="sd">    By maintaining a collection with tracks having tag data (e.g. genre tags,</span>
<span class="sd">    Rekordbox&#39;s &quot;My Tags&quot;, etc.) and providing a playlist config which</span>
<span class="sd">    specifies a desired playlist structure based around these tags, users can</span>
<span class="sd">    automatically generate that playlist structure.</span>

<span class="sd">    The playlist config is a YAML file which specifies a nested structure of</span>
<span class="sd">    folders. Each folder is declared with a &quot;name&quot; and a list of &quot;playlists&quot;</span>
<span class="sd">    which may be either more folder declarations or else strings matching a tag</span>
<span class="sd">    in your collection.</span>

<span class="sd">    Any folder that has more than one playlist within it will automatically</span>
<span class="sd">    have an &quot;All &lt;folder name&gt;&quot; playlist added to it that contains the set of</span>
<span class="sd">    tracks from all the other playlists in that folder.</span>

<span class="sd">    Any tag in your collection that is not specified in the playlist config</span>
<span class="sd">    will automatically be added to either an &quot;Other&quot; folder of playlists or an</span>
<span class="sd">    &quot;Other&quot; playlist (depending on your configured choice for</span>
<span class="sd">    collection_playlists_remainder).</span>

<span class="sd">    A special folder with the name &quot;_ignore&quot; may be included anywhere within</span>
<span class="sd">    the &quot;tags&quot; specification with playlists matching the set of tags to ignore</span>
<span class="sd">    when creating the &quot;Other&quot; folder / playlist.</span>

<span class="sd">    In addition to creating playlists from tags, this function also supports</span>
<span class="sd">    creating &quot;combiner&quot; playlists by evaluating boolean algebra expressions.</span>
<span class="sd">    This is an incredibly powerful feature which allows users to apply set</span>
<span class="sd">    operations {union, intersection, and difference} to a diverse range of</span>
<span class="sd">    operands {tag, playlists, BPMs, ratings, etc.}.</span>

<span class="sd">    Combiner playlists are declared in the &quot;combiner&quot; specification of the</span>
<span class="sd">    playlist config with playlists whose names are the boolean algebra</span>
<span class="sd">    expressions used to construct them.</span>

<span class="sd">    Here&#39;s an example combiner playlist to illustrate this:</span>

<span class="sd">        ((Dubstep ~ [1-3]) | {playlist: My Favorites} | (*Techno &amp; [135-145])) &amp; Dark</span>

<span class="sd">    The resulting combiner playlist will be comprised of tracks that are:</span>

<span class="sd">    - tagged as &quot;Dubstep&quot; but NOT having a rating less than 4</span>
<span class="sd">    - OR in the playlist called &quot;My Favorites&quot;</span>
<span class="sd">    - OR tagged as something ending with &quot;Techno&quot; AND in the BPM range of 135</span>
<span class="sd">    to 145</span>
<span class="sd">    - AND tagged as &quot;Dark&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        path: Path to write the new collection to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the playlist config is populated before continuing.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span>
        <span class="ow">or</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span>
    <span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Not building playlists because the playlist config is empty.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Load the collection.</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;collection&quot;</span><span class="p">](</span>
        <span class="n">path</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_path</span>
    <span class="p">)</span>

    <span class="c1"># Get the Playlist implementation to use for this collection.</span>
    <span class="n">playlist_class</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;playlist&quot;</span><span class="p">]</span>

    <span class="c1"># Required number of tracks to make tag and combiner playlists.</span>
    <span class="n">minimum_tag_tracks</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">minimum_tag_playlist_tracks</span>
    <span class="n">minimum_combiner_tracks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">minimum_combiner_playlist_tracks</span>
    <span class="p">)</span>

    <span class="c1"># Create a dict of tracks keyed by their individual tags.</span>
    <span class="n">tags_tracks</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_tags</span><span class="p">():</span>
            <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>

    <span class="c1"># This will hold the playlists being built.</span>
    <span class="n">auto_playlists</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># List of PlaylistFilter implementations to run against built playlists.</span>
    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">playlist_filters</span><span class="p">,</span> <span class="n">playlist_filter</span><span class="o">.</span><span class="n">value</span><span class="p">)()</span>
        <span class="k">for</span> <span class="n">playlist_filter</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_playlist_filters</span>
    <span class="p">]</span>

    <span class="c1"># Create playlists for the &quot;tags&quot; portion of the playlist config.</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span><span class="p">:</span>
        <span class="c1"># A set of tags seen is maintained while creating the tags playlists so</span>
        <span class="c1"># that they are ignored when creating the &quot;Other&quot; playlists.</span>
        <span class="n">seen_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">tag_playlists</span> <span class="o">=</span> <span class="n">build_tag_playlists</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">playlist_class</span><span class="p">,</span>
            <span class="n">seen_tags</span><span class="p">,</span>
            <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The tag playlists must have their &quot;parent&quot; attribute set so that</span>
        <span class="c1"># PlaylistFilter implementations may apply logic that depends on the</span>
        <span class="c1"># relative position of the playlist with the playlist tree.</span>
        <span class="n">tag_playlists</span><span class="o">.</span><span class="n">set_parent</span><span class="p">()</span>

        <span class="c1"># Apply the filtering logic of the configured PlaylistFilter implementations.</span>
        <span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">tag_playlists</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>

        <span class="c1"># Recursively traverse the playlist tree and create &quot;all&quot; playlists</span>
        <span class="c1"># within each folder containing more than one playlist. These &quot;all&quot;</span>
        <span class="c1"># playlists aggregate the set of tracks contained within all the other</span>
        <span class="c1"># playlists within the same folder.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">aggregate_playlists</span><span class="p">(</span>
            <span class="n">tag_playlists</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_tag_tracks</span>
        <span class="p">)</span>

        <span class="n">auto_playlists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tag_playlists</span><span class="p">)</span>

        <span class="c1"># Identify the set of tags that did not appear in the playlist config</span>
        <span class="c1"># and create either an &quot;Other&quot; folder of playlists or simply an &quot;Other&quot;</span>
        <span class="c1"># playlist.</span>
        <span class="n">other_tags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tags_tracks</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">seen_tags</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_playlists_remainder</span>
            <span class="o">==</span> <span class="n">PlaylistRemainder</span><span class="o">.</span><span class="n">FOLDER</span>
        <span class="p">):</span>
            <span class="n">auto_playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">build_tag_playlists</span><span class="p">(</span>
                    <span class="n">PlaylistConfigContent</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unused Tags&quot;</span><span class="p">,</span> <span class="n">playlists</span><span class="o">=</span><span class="n">other_tags</span>
                    <span class="p">),</span>
                    <span class="n">tags_tracks</span><span class="p">,</span>
                    <span class="n">playlist_class</span><span class="p">,</span>
                    <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">auto_playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">build_tag_playlists</span><span class="p">(</span>
                    <span class="s2">&quot;Unused Tags&quot;</span><span class="p">,</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Unused Tags&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
                            <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">track_dict</span> <span class="ow">in</span> <span class="n">tags_tracks</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                            <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">track_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                            <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">other_tags</span>
                        <span class="p">}</span>
                    <span class="p">},</span>
                    <span class="n">playlist_class</span><span class="p">,</span>
                    <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tag_tracks</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Create playlists for the &quot;combiner&quot; portion of the playlist config.</span>
    <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">:</span>
        <span class="c1"># Parse selectors from the combiner playlist names and update the</span>
        <span class="c1"># tags_tracks mapping.</span>
        <span class="n">add_selectors_to_tags</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">collection</span><span class="p">,</span>
            <span class="n">auto_playlists</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Evaluate the boolean logic of the combiner playlists.</span>
        <span class="n">combiner_playlists</span> <span class="o">=</span> <span class="n">build_combiner_playlists</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">playlist_config</span><span class="o">.</span><span class="n">combiner</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">playlist_class</span><span class="p">,</span>
            <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_combiner_tracks</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The tag playlists must have their &quot;parent&quot; attribute set so that</span>
        <span class="c1"># PlaylistFilter implementations may apply logic that depends on the</span>
        <span class="c1"># relative position of the playlist with the playlist tree.</span>
        <span class="n">combiner_playlists</span><span class="o">.</span><span class="n">set_parent</span><span class="p">()</span>

        <span class="c1"># Apply the filtering logic of the configured PlaylistFilter implementations.</span>
        <span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>

        <span class="c1"># Recursively traverse the playlist tree and create &quot;all&quot; playlists</span>
        <span class="c1"># within each folder containing more than one playlist. These &quot;all&quot;</span>
        <span class="c1"># playlists aggregate the set of tracks contained within all the other</span>
        <span class="c1"># playlists within the same folder.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">aggregate_playlists</span><span class="p">(</span>
            <span class="n">combiner_playlists</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_combiner_tracks</span>
        <span class="p">)</span>

        <span class="n">auto_playlists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">)</span>

        <span class="c1"># Print tag statistics for each combiner playlist.</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">verbosity</span> <span class="ow">and</span> <span class="n">combiner_playlists</span><span class="p">:</span>
            <span class="n">print_playlists_tag_statistics</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">)</span>

    <span class="c1"># Remove any previous playlist builder playlists.</span>
    <span class="n">previous_playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">PLAYLIST_NAME</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">previous_playlists</span><span class="p">:</span>
        <span class="n">root</span><span class="o">.</span><span class="n">remove_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span>

    <span class="c1"># Insert a new playlist containing the built playlists.</span>
    <span class="n">auto_playlist</span> <span class="o">=</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">PLAYLIST_NAME</span><span class="p">,</span> <span class="n">playlists</span><span class="o">=</span><span class="n">auto_playlists</span>
    <span class="p">)</span>
    <span class="n">auto_playlist</span><span class="o">.</span><span class="n">set_parent</span><span class="p">(</span><span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">())</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">add_playlist</span><span class="p">(</span><span class="n">auto_playlist</span><span class="p">)</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>

    <span class="n">num_playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">()</span><span class="o">.</span><span class="n">get_number_of_playlists</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PLAYLIST_NAME</span><span class="si">}</span><span class="s2"> generated with </span><span class="si">{</span><span class="n">num_playlists</span><span class="si">}</span><span class="s2"> playlists&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.playlist_filters"></a>
    <div class="doc doc-contents first">

        <p>This module contains the PlaylistFilter abstract base class and its
implementations.</p>
<p>PlaylistFilter subclasses implement an 'is_filter_playlist' method and a
'filter_track' method.</p>
<p>The 'is_filter_playlist' method, when given a 'Playlist', returns true if that
'Playlist' should have its tracks filtered.</p>
<p>The 'filter_track' method, when given a 'Track', returns true if that 'Track'
should remain in the playlist.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="djtools.collection.playlist_filters.ComplexTrackFilter" class="doc doc-heading">
            <code>ComplexTrackFilter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="djtools.collection.playlist_filters.PlaylistFilter" href="../../developer_docs/playlist_filters/#djtools.collection.playlist_filters.PlaylistFilter">PlaylistFilter</a></code></p>


        <p>This class filters "complex" playlists.</p>
<p>This PlaylistFilter looks for playlists with "complex" in their name or in
the name of a parent playlist. When found, tracks contained in the playlist
must have no less than 'min_tags_for_complex_track' in order to remain in
the playlist.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ComplexTrackFilter</span><span class="p">(</span><span class="n">PlaylistFilter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class filters &quot;complex&quot; playlists.</span>

<span class="sd">    This PlaylistFilter looks for playlists with &quot;complex&quot; in their name or in</span>
<span class="sd">    the name of a parent playlist. When found, tracks contained in the playlist</span>
<span class="sd">    must have no less than &#39;min_tags_for_complex_track&#39; in order to remain in</span>
<span class="sd">    the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">min_tags_for_complex_track</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">exclude_tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            min_tags_for_complex_track: Maximum number of non-genre tags before</span>
<span class="sd">                a track is no longer considered &quot;complex&quot;.</span>
<span class="sd">            exclude_tags: Tags to ignore when determining the number of</span>
<span class="sd">                non-genre tags.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_min_tags_for_complex_track</span> <span class="o">=</span> <span class="n">min_tags_for_complex_track</span>
        <span class="k">if</span> <span class="n">exclude_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">exclude_tags</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Flute&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Guitar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Horn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Piano&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Scratch&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Strings&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Vocal&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_tags</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: Track object to apply filter to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not this track should be included in the playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other_tags</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_tags</span><span class="p">())</span>
            <span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()))</span>
            <span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exclude_tags</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">other_tags</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_tags</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_tags_for_complex_track</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Playlist object to potentially filter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not to filter this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">playlist_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*complex.*&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.ComplexTrackFilter.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">min_tags_for_complex_track</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">exclude_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>min_tags_for_complex_track</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of non-genre tags before
a track is no longer considered "complex".</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exclude_tags</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tags to ignore when determining the number of
non-genre tags.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">min_tags_for_complex_track</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">exclude_tags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Args:</span>
<span class="sd">        min_tags_for_complex_track: Maximum number of non-genre tags before</span>
<span class="sd">            a track is no longer considered &quot;complex&quot;.</span>
<span class="sd">        exclude_tags: Tags to ignore when determining the number of</span>
<span class="sd">            non-genre tags.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_min_tags_for_complex_track</span> <span class="o">=</span> <span class="n">min_tags_for_complex_track</span>
    <span class="k">if</span> <span class="n">exclude_tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exclude_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Flute&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Guitar&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Horn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Piano&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Scratch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Strings&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Vocal&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_tags</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.ComplexTrackFilter.filter_track" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this track should remain in the playlist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object to apply filter to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this track should be included in the playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object to apply filter to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not this track should be included in the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">other_tags</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_tags</span><span class="p">())</span>
        <span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()))</span>
        <span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exclude_tags</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">other_tags</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_tags</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_tags_for_complex_track</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.ComplexTrackFilter.is_filter_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this playlist should be filtered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object to potentially filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to filter this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist object to potentially filter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not to filter this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">playlist_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*complex.*&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.playlist_filters.HipHopFilter" class="doc doc-heading">
            <code>HipHopFilter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="djtools.collection.playlist_filters.PlaylistFilter" href="../../developer_docs/playlist_filters/#djtools.collection.playlist_filters.PlaylistFilter">PlaylistFilter</a></code></p>


        <p>This class filters playlists called "Hip Hop".</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">HipHopFilter</span><span class="p">(</span><span class="n">PlaylistFilter</span><span class="p">):</span>
    <span class="s1">&#39;This class filters playlists called &quot;Hip Hop&quot;.&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">        If the playlist is not underneath a folder called &quot;Bass&quot;, then this</span>
<span class="sd">        track is filtered out unless it has exclusively &quot;Hip Hop&quot; and &quot;R&amp;B&quot;</span>
<span class="sd">        genre tags. If the playlist is underneath a folder called &quot;Bass&quot;, then</span>
<span class="sd">        this track is filtered out if it does have exclusively &quot;Hip Hop&quot; and</span>
<span class="sd">        &quot;R&amp;B&quot; genre tags.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: Track object to apply filter to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not this track should be included in the playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pure_hip_hop_with_other_tags</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
            <span class="s2">&quot;r&amp;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;hip hop&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">bass_hip_hop_without_other_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
            <span class="s2">&quot;r&amp;b&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;hip hop&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">pure_hip_hop_with_other_tags</span> <span class="ow">or</span> <span class="n">bass_hip_hop_without_other_tags</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist&#39;s name is &quot;Hip Hop&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Playlist object to potentially filter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not to filter this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
            <span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Hip Hop&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Bass&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                    <span class="kc">True</span>
                <span class="p">)</span>
                <span class="k">break</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.HipHopFilter.filter_track" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this track should remain in the playlist.</p>
<p>If the playlist is not underneath a folder called "Bass", then this
track is filtered out unless it has exclusively "Hip Hop" and "R&amp;B"
genre tags. If the playlist is underneath a folder called "Bass", then
this track is filtered out if it does have exclusively "Hip Hop" and
"R&amp;B" genre tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object to apply filter to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this track should be included in the playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">    If the playlist is not underneath a folder called &quot;Bass&quot;, then this</span>
<span class="sd">    track is filtered out unless it has exclusively &quot;Hip Hop&quot; and &quot;R&amp;B&quot;</span>
<span class="sd">    genre tags. If the playlist is underneath a folder called &quot;Bass&quot;, then</span>
<span class="sd">    this track is filtered out if it does have exclusively &quot;Hip Hop&quot; and</span>
<span class="sd">    &quot;R&amp;B&quot; genre tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object to apply filter to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not this track should be included in the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pure_hip_hop_with_other_tags</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
        <span class="s2">&quot;r&amp;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;hip hop&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">bass_hip_hop_without_other_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
        <span class="s2">&quot;r&amp;b&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;hip hop&quot;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">pure_hip_hop_with_other_tags</span> <span class="ow">or</span> <span class="n">bass_hip_hop_without_other_tags</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.HipHopFilter.is_filter_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this playlist's name is "Hip Hop".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object to potentially filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to filter this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist&#39;s name is &quot;Hip Hop&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist object to potentially filter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not to filter this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="kc">False</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Hip Hop&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Bass&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bass_hip_hop</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                <span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">break</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.playlist_filters.MinimalDeepTechFilter" class="doc doc-heading">
            <code>MinimalDeepTechFilter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="djtools.collection.playlist_filters.PlaylistFilter" href="../../developer_docs/playlist_filters/#djtools.collection.playlist_filters.PlaylistFilter">PlaylistFilter</a></code></p>


        <p>This class filters playlists called "Minimal Deep Tech".</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MinimalDeepTechFilter</span><span class="p">(</span><span class="n">PlaylistFilter</span><span class="p">):</span>
    <span class="s1">&#39;This class filters playlists called &quot;Minimal Deep Tech&quot;.&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">        If the playlist is not underneath a folder called &quot;Techno&quot;, then this</span>
<span class="sd">        track is filtered out if there&#39;s another genre tag containing &quot;Techno&quot;.</span>
<span class="sd">        If the playlist is underneath a folder called &quot;Techno&quot;, then</span>
<span class="sd">        this track is filtered out if there&#39;s no other genre tag containing</span>
<span class="sd">        &quot;Techno&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: Track object to apply filter to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not this track should be included in the playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">house_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*house.*&quot;</span><span class="p">)</span>
        <span class="n">techno_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*techno.*&quot;</span><span class="p">)</span>
        <span class="n">house_tag</span> <span class="o">=</span> <span class="n">techno_tag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">house_exp</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="n">house_tag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">techno_exp</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="n">techno_tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">techno_tag</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">house_tag</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist&#39;s name is &quot;Minimal Deep Tech&quot;.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Playlist object to potentially filter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not to filter this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Minimal Deep Tech&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Techno&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                    <span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;House&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                    <span class="kc">True</span>
                <span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_house</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.MinimalDeepTechFilter.filter_track" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this track should remain in the playlist.</p>
<p>If the playlist is not underneath a folder called "Techno", then this
track is filtered out if there's another genre tag containing "Techno".
If the playlist is underneath a folder called "Techno", then
this track is filtered out if there's no other genre tag containing
"Techno".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object to apply filter to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this track should be included in the playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">    If the playlist is not underneath a folder called &quot;Techno&quot;, then this</span>
<span class="sd">    track is filtered out if there&#39;s another genre tag containing &quot;Techno&quot;.</span>
<span class="sd">    If the playlist is underneath a folder called &quot;Techno&quot;, then</span>
<span class="sd">    this track is filtered out if there&#39;s no other genre tag containing</span>
<span class="sd">    &quot;Techno&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object to apply filter to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not this track should be included in the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">house_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*house.*&quot;</span><span class="p">)</span>
    <span class="n">techno_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*techno.*&quot;</span><span class="p">)</span>
    <span class="n">house_tag</span> <span class="o">=</span> <span class="n">techno_tag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">house_exp</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">house_tag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">techno_exp</span><span class="p">,</span> <span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">techno_tag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">techno_tag</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">house_tag</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.MinimalDeepTechFilter.is_filter_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this playlist's name is "Minimal Deep Tech".</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object to potentially filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to filter this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist&#39;s name is &quot;Minimal Deep Tech&quot;.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist object to potentially filter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not to filter this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Minimal Deep Tech&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Techno&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                <span class="kc">True</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;House&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_house</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># pylint: disable=attribute-defined-outside-init</span>
                <span class="kc">True</span>
            <span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_techno</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_house</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.playlist_filters.PlaylistFilter" class="doc doc-heading">
            <code>PlaylistFilter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>This class defines an interface for filtering tracks from playlists.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PlaylistFilter</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="s2">&quot;This class defines an interface for filtering tracks from playlists.&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: Track object to apply filter to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not this track should be included in the playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Playlist object to potentially filter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not to filter this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.PlaylistFilter.filter_track" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this track should remain in the playlist.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object to apply filter to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this track should be included in the playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object to apply filter to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not this track should be included in the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.PlaylistFilter.is_filter_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this playlist should be filtered.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object to potentially filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to filter this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist object to potentially filter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not to filter this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="djtools.collection.playlist_filters.TransitionTrackFilter" class="doc doc-heading">
            <code>TransitionTrackFilter</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="djtools.collection.playlist_filters.PlaylistFilter" href="../../developer_docs/playlist_filters/#djtools.collection.playlist_filters.PlaylistFilter">PlaylistFilter</a></code></p>


        <p>This class filters "transition" playlists.</p>
<p>This PlaylistFilter looks for playlists with "transition" in their name or in
the name of a parent playlist. When found, tracks contained in the playlist
must have a square bracket enclosed set of transition tokens (forward-slash
delimited list of floats, for BPMs, or otherwise, for genres).</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TransitionTrackFilter</span><span class="p">(</span><span class="n">PlaylistFilter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class filters &quot;transition&quot; playlists.</span>

<span class="sd">    This PlaylistFilter looks for playlists with &quot;transition&quot; in their name or in</span>
<span class="sd">    the name of a parent playlist. When found, tracks contained in the playlist</span>
<span class="sd">    must have a square bracket enclosed set of transition tokens (forward-slash</span>
<span class="sd">    delimited list of floats, for BPMs, or otherwise, for genres).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            separator: Character used to separate transition tokens.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_separator</span> <span class="o">=</span> <span class="n">separator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">        Matches square bracket enclosed tokens representing transitions for</span>
<span class="sd">        supported playlist types.</span>

<span class="sd">        Args:</span>
<span class="sd">            track: Track object to apply filter to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not this track should be included in the playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">comments</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">get_comments</span><span class="p">()</span>
        <span class="n">transition_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[([^]]+)\]&quot;</span><span class="p">)</span>
        <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">transition_exp</span><span class="p">,</span> <span class="n">comments</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_separator</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">==</span> <span class="s2">&quot;tempo&quot;</span><span class="p">:</span>
                    <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">==</span> <span class="s2">&quot;genre&quot;</span><span class="p">:</span>
                    <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">transition_tokens_match_playlist_type</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">        Identifies playlists with a supported transition playlist type in its</span>
<span class="sd">        name while also having a parent playlist with &quot;transition&quot; in its name.</span>

<span class="sd">        Args:</span>
<span class="sd">            playlist: Playlist object to potentially filter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not to filter this playlist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Check if the given playlist has a substring of &quot;transition&quot;.</span>
        <span class="n">playlist_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*transition.*&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Search parents&#39; names for &quot;transition&quot; substring.</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">is_transition_playlist</span> <span class="ow">and</span> <span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_transition_playlist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check if the given playlist contains one, and only one, of the</span>
        <span class="c1"># supported transition playlist types.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">playlist_type_exprs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;genre&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*genre.*&quot;</span><span class="p">),</span>
            <span class="s2">&quot;tempo&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*tempo.*&quot;</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">playlist_type</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">playlist_type_exprs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot; matches multiple playlist types:&#39;</span>
                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">playlist_type</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="n">playlist_type</span>

        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.TransitionTrackFilter.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">separator</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>separator</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character used to separate transition tokens.</p>
              </div>
            </td>
            <td>
                  <code>&#39;/&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Args:</span>
<span class="sd">        separator: Character used to separate transition tokens.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_separator</span> <span class="o">=</span> <span class="n">separator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.TransitionTrackFilter.filter_track" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this track should remain in the playlist.</p>
<p>Matches square bracket enclosed tokens representing transitions for
supported playlist types.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object to apply filter to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not this track should be included in the playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this track should remain in the playlist.</span>

<span class="sd">    Matches square bracket enclosed tokens representing transitions for</span>
<span class="sd">    supported playlist types.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object to apply filter to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not this track should be included in the playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">comments</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">get_comments</span><span class="p">()</span>
    <span class="n">transition_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\[([^]]+)\]&quot;</span><span class="p">)</span>
    <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">transition_exp</span><span class="p">,</span> <span class="n">comments</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_separator</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">==</span> <span class="s2">&quot;tempo&quot;</span><span class="p">:</span>
                <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">==</span> <span class="s2">&quot;genre&quot;</span><span class="p">:</span>
                <span class="n">transition_tokens_match_playlist_type</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">transition_tokens_match_playlist_type</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.playlist_filters.TransitionTrackFilter.is_filter_playlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns True if this playlist should be filtered.</p>
<p>Identifies playlists with a supported transition playlist type in its
name while also having a parent playlist with "transition" in its name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object to potentially filter.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to filter this playlist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/playlist_filters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_filter_playlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns True if this playlist should be filtered.</span>

<span class="sd">    Identifies playlists with a supported transition playlist type in its</span>
<span class="sd">    name while also having a parent playlist with &quot;transition&quot; in its name.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist object to potentially filter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not to filter this playlist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Check if the given playlist has a substring of &quot;transition&quot;.</span>
    <span class="n">playlist_exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*transition.*&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
        <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Search parents&#39; names for &quot;transition&quot; substring.</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">is_transition_playlist</span> <span class="ow">and</span> <span class="n">parent</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">playlist_exp</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="n">is_transition_playlist</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_transition_playlist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Check if the given playlist contains one, and only one, of the</span>
    <span class="c1"># supported transition playlist types.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">playlist_type_exprs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;genre&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*genre.*&quot;</span><span class="p">),</span>
        <span class="s2">&quot;tempo&quot;</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*tempo.*&quot;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">playlist_type</span><span class="p">,</span> <span class="n">exp</span> <span class="ow">in</span> <span class="n">playlist_type_exprs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot; matches multiple playlist types:&#39;</span>
                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">playlist_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span> <span class="o">=</span> <span class="n">playlist_type</span>

    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_playlist_type</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.shuffle_playlists"></a>
    <div class="doc doc-contents first">

        <p>This module is used to emulate shuffling the track order of one or more
playlists. This is done by setting the track number attribute of each track in
sequential order after collecting the set of Tracks from the provided
playlist(s).</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.collection.shuffle_playlists.shuffle_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shuffle_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>For each playlist in "shuffle_playlists", randomize the tracks and
sequentially set the track number to emulate shuffling.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.collection.shuffle_playlists.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to write the new collection to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/shuffle_playlists.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">shuffle_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For each playlist in &quot;shuffle_playlists&quot;, randomize the tracks and</span>
<span class="sd">    sequentially set the track number to emulate shuffling.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        path: Path to write the new collection to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Load collection.</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;collection&quot;</span><span class="p">](</span>
        <span class="n">path</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_path</span>
    <span class="p">)</span>

    <span class="c1"># Build a dict of tracks to shuffle from the provided list of playlists.</span>
    <span class="n">shuffled_tracks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">playlist_name</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">shuffle_playlists</span><span class="p">:</span>
        <span class="n">playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">(</span><span class="n">playlist_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlists</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlists</span><span class="p">:</span>
            <span class="n">tracks</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span>
            <span class="n">track_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tracks</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">track_keys</span><span class="p">)</span>
            <span class="n">shuffled_tracks</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">tracks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">track_keys</span><span class="p">})</span>

    <span class="c1"># Apply the shuffled track number to the attribute of the tracks.</span>
    <span class="n">shuffled_tracks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shuffled_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">[</span><span class="n">shuffled_tracks</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">shuffled_tracks</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))]</span>
    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
        <span class="n">max_workers</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># pylint: disable=no-member</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">set_track_number</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">track</span><span class="p">,</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">payload</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span>
            <span class="n">desc</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Randomizing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span><span class="si">}</span><span class="s2"> tracks&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">_</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

    <span class="c1"># Insert a new playlist containing just the shuffled tracks.</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">add_playlist</span><span class="p">(</span>
        <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;playlist&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SHUFFLE&quot;</span><span class="p">,</span>
            <span class="n">tracks</span><span class="o">=</span><span class="p">{</span><span class="n">track</span><span class="o">.</span><span class="n">get_id</span><span class="p">():</span> <span class="n">track</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">shuffled_tracks</span><span class="p">},</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.copy_playlists"></a>
    <div class="doc doc-contents first">

        <p>This module is used to copy the audio files from the provided playlists to a
new location and serialize a new collection with those tracks pointing to these
new locations.</p>
<p>The purpose of this utility is to:</p>
<ul>
<li>backup subsets of your library</li>
<li>ensure you have easy access to a preparation independent of the setup</li>
</ul>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="djtools.collection.copy_playlists.copy_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Copies tracks from provided playlists to a destination.</p>
<p>Serializes the collection with these playlists and updated locations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="djtools.collection.copy_playlists.BaseConfig">BaseConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to write the new collection to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="LookupError">LookupError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist names in copy_playlists must exist in
"collection_path".</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/copy_playlists.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">copy_playlists</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">BaseConfig</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copies tracks from provided playlists to a destination.</span>

<span class="sd">    Serializes the collection with these playlists and updated locations.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: Configuration object.</span>
<span class="sd">        path: Path to write the new collection to.</span>

<span class="sd">    Raises:</span>
<span class="sd">        LookupError: Playlist names in copy_playlists must exist in</span>
<span class="sd">            &quot;collection_path&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Load collection.</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">PLATFORM_REGISTRY</span><span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">platform</span><span class="p">][</span><span class="s2">&quot;collection&quot;</span><span class="p">](</span>
        <span class="n">path</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_path</span>
    <span class="p">)</span>

    <span class="c1"># Create destination directory.</span>
    <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">copy_playlists_destination</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span>
        <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">playlist_tracks</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">lineage</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
    <span class="n">playlists</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Get the playlists from the collection.</span>
    <span class="k">for</span> <span class="n">playlist_name</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">copy_playlists</span><span class="p">:</span>
        <span class="n">found_playlists</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">(</span><span class="n">playlist_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">found_playlists</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">playlist_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="n">playlists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">playlist</span>
                <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">found_playlists</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">is_folder</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># Traverse the playlist to get tracks for the desired playlists and mark</span>
    <span class="c1"># the rest for removal.</span>
    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlists</span><span class="p">:</span>
        <span class="n">playlist_tracks</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">())</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">parent</span><span class="p">:</span>
            <span class="n">lineage</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">playlists</span> <span class="ow">and</span> <span class="n">child</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lineage</span><span class="p">:</span>
                    <span class="n">lineage</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
    <span class="n">collection</span><span class="o">.</span><span class="n">set_tracks</span><span class="p">(</span><span class="n">playlist_tracks</span><span class="p">)</span>

    <span class="c1"># Remove the extra playlists.</span>
    <span class="k">for</span> <span class="n">parent</span><span class="p">,</span> <span class="n">children</span> <span class="ow">in</span> <span class="n">lineage</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">remove_playlist</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>

    <span class="c1"># Copy tracks to the destination and update their location.</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">playlist_tracks</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
        <span class="p">[</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">copy_playlists_destination</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">playlist_tracks</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span>
        <span class="n">max_workers</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># pylint: disable=no-member</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">copy_file</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Copying tracks&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Unless specified, write the output collection to the same directory that</span>
    <span class="c1"># the files are being copied to.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">copy_playlists_destination</span>
            <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;copied_playlists_collection</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">collection_path</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Serialize the new collection.</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="djtools.collection.helpers"></a>
    <div class="doc doc-contents first">

        <p>This module contains helpers for the collection package.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="djtools.collection.helpers.BooleanNode" class="doc doc-heading">
            <code>BooleanNode</code>


</h2>


    <div class="doc doc-contents ">


        <p>Node that contains boolean logic for a sub-expression.</p>







              <details class="quote">
                <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">BooleanNode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Node that contains boolean logic for a sub-expression.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]],</span>
        <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BooleanNode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            tags_tracks: Dict of tags to tracks.</span>
<span class="sd">            parent: BooleanNode of which this node is a sub-expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ops</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;&amp;&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">,</span>
            <span class="s2">&quot;|&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">,</span>
            <span class="s2">&quot;~&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">difference</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tags_tracks</span> <span class="o">=</span> <span class="n">tags_tracks</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_tracks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets set of track IDs for the provided tag.</span>

<span class="sd">        If the tag contains a wildcard, denoted with &quot;*&quot;, then the union of</span>
<span class="sd">        track IDs with a tag containing the provided tag as a sub-string is</span>
<span class="sd">        returned.</span>

<span class="sd">        Args:</span>
<span class="sd">            tag: Tag for indexing tracks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Set of track IDs for the provided tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">tag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">NUMERICAL_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">STRING_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;$&quot;</span><span class="p">)</span>
            <span class="n">tracks</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags_tracks</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                    <span class="n">tracks</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tags_tracks</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">tracks</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tags_tracks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="p">{})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add operand to BooleanNode.</span>

<span class="sd">        Args:</span>
<span class="sd">            operand: Tag or track set to be evaluated.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Empty string to reset tag in the parse_expression function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">operand</span> <span class="o">=</span> <span class="n">operand</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">operand</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a set operation to the BooleanNode.</span>

<span class="sd">        Args:</span>
<span class="sd">            operator: Character representing a set operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ops</span><span class="p">[</span><span class="n">operator</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies operators to the operands to produce a dict of tracks.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: The boolean expression is malformed. It must contain</span>
<span class="sd">                one less operator than there are operands.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict of tracks reduced from the boolean expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">):</span>
            <span class="n">operands</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; tracks&quot;</span>
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span>
            <span class="p">]</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Invalid boolean expression:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">operands: </span><span class="si">{</span><span class="n">operands</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">operators: </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">:</span>
            <span class="n">tracks_a</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tracks</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">tracks_b</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tracks</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">track_ids</span> <span class="o">=</span> <span class="n">operator</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tracks_a</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">tracks_b</span><span class="p">))</span>
            <span class="n">tracks</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
                <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="p">{</span><span class="o">**</span><span class="n">tracks_a</span><span class="p">,</span> <span class="o">**</span><span class="n">tracks_b</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">track_id</span> <span class="ow">in</span> <span class="n">track_ids</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tracks</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">),</span> <span class="nb">set</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BooleanNode&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the parent of the BooleanNode.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parent BooleanNode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a character is one that represents a set operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            char: Character that may represent a set operation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether or not the character is an operator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ops</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">tags_tracks</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Constructor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tags_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tags to tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parent</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="BooleanNode (djtools.collection.helpers.BooleanNode)" href="#djtools.collection.helpers.BooleanNode">BooleanNode</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>BooleanNode of which this node is a sub-expression.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]],</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BooleanNode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor.</span>

<span class="sd">    Args:</span>
<span class="sd">        tags_tracks: Dict of tags to tracks.</span>
<span class="sd">        parent: BooleanNode of which this node is a sub-expression.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ops</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;&amp;&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">,</span>
        <span class="s2">&quot;|&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">,</span>
        <span class="s2">&quot;~&quot;</span><span class="p">:</span> <span class="nb">set</span><span class="o">.</span><span class="n">difference</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tags_tracks</span> <span class="o">=</span> <span class="n">tags_tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.add_operand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_operand</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add operand to BooleanNode.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>operand</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag or track set to be evaluated.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Empty string to reset tag in the parse_expression function.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_operand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add operand to BooleanNode.</span>

<span class="sd">    Args:</span>
<span class="sd">        operand: Tag or track set to be evaluated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Empty string to reset tag in the parse_expression function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operand</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">operand</span> <span class="o">=</span> <span class="n">operand</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">operand</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operand</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.add_operator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_operator</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds a set operation to the BooleanNode.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>operator</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character representing a set operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operator</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a set operation to the BooleanNode.</span>

<span class="sd">    Args:</span>
<span class="sd">        operator: Character representing a set operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ops</span><span class="p">[</span><span class="n">operator</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.evaluate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evaluate</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Applies operators to the operands to produce a dict of tracks.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The boolean expression is malformed. It must contain
one less operator than there are operands.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict of tracks reduced from the boolean expression.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies operators to the operands to produce a dict of tracks.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: The boolean expression is malformed. It must contain</span>
<span class="sd">            one less operator than there are operands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict of tracks reduced from the boolean expression.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">):</span>
        <span class="n">operands</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; tracks&quot;</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span>
        <span class="p">]</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid boolean expression:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">operands: </span><span class="si">{</span><span class="n">operands</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">operators: </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="p">:</span>
        <span class="n">tracks_a</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tracks</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">tracks_b</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tracks</span><span class="p">(</span><span class="n">tag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operators</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">track_ids</span> <span class="o">=</span> <span class="n">operator</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tracks_a</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">tracks_b</span><span class="p">))</span>
        <span class="n">tracks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
            <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="p">{</span><span class="o">**</span><span class="n">tracks_a</span><span class="p">,</span> <span class="o">**</span><span class="n">tracks_b</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">track_id</span> <span class="ow">in</span> <span class="n">track_ids</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tracks</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_operands</span><span class="p">),</span> <span class="nb">set</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.get_parent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parent</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Gets the parent of the BooleanNode.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="BooleanNode (djtools.collection.helpers.BooleanNode)" href="#djtools.collection.helpers.BooleanNode">BooleanNode</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parent BooleanNode.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;BooleanNode&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the parent of the BooleanNode.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parent BooleanNode.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="djtools.collection.helpers.BooleanNode.is_operator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_operator</span><span class="p">(</span><span class="n">char</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if a character is one that represents a set operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>char</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Character that may represent a set operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the character is an operator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_operator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if a character is one that represents a set operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        char: Character that may represent a set operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether or not the character is an operator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ops</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.add_selectors_to_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_selectors_to_tags</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">auto_playlists</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Recursively update the track lookup with selectors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="PlaylistConfigContent (djtools.collection.config.PlaylistConfigContent)" href="#djtools.collection.config.PlaylistConfigContent">PlaylistConfigContent</a>, <a class="autorefs autorefs-internal" title="PlaylistName (djtools.collection.config.PlaylistName)" href="#djtools.collection.config.PlaylistName">PlaylistName</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A component of a playlist config to create a playlist for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tags to tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>collection</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_collection.Collection">Collection</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collection object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>auto_playlists</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="djtools.collection.base_playlist.Playlist">Playlist</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag playlists built in this same run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_selectors_to_tags</span><span class="p">(</span>
    <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PlaylistConfigContent</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]],</span>
    <span class="n">collection</span><span class="p">:</span> <span class="n">Collection</span><span class="p">,</span>
    <span class="n">auto_playlists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Playlist</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively update the track lookup with selectors.</span>

<span class="sd">    Args:</span>
<span class="sd">        content: A component of a playlist config to create a playlist for.</span>
<span class="sd">        tags_tracks: Dict of tags to tracks.</span>
<span class="sd">        collection: Collection object.</span>
<span class="sd">        auto_playlists: Tag playlists built in this same run.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This is a folder so parse selectors from playlists within it.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistConfigContent</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">playlists</span><span class="p">:</span>
            <span class="n">add_selectors_to_tags</span><span class="p">(</span>
                <span class="n">playlist</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">,</span> <span class="n">collection</span><span class="p">,</span> <span class="n">auto_playlists</span>
            <span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># This is not a folder so these playlists must have their selectors parsed.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">):</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">tag_content</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">content</span>

    <span class="n">numerical_value_lookup</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">string_selector_type_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;artist&quot;</span><span class="p">:</span> <span class="s2">&quot;get_artists&quot;</span><span class="p">,</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;get_comments&quot;</span><span class="p">,</span>
        <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;get_date_added&quot;</span><span class="p">,</span>
        <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;get_key&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;get_label&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">string_value_lookup</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">playlists</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Grab selectors from Combiner playlist name.</span>
    <span class="n">parse_numerical_selectors</span><span class="p">(</span>
        <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">NUMERICAL_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">tag_content</span><span class="p">),</span>
        <span class="n">numerical_value_lookup</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parse_string_selectors</span><span class="p">(</span>
        <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">STRING_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">tag_content</span><span class="p">),</span>
        <span class="n">string_value_lookup</span><span class="p">,</span>
        <span class="n">string_selector_type_map</span><span class="p">,</span>
        <span class="n">playlists</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add keys for numerical selectors for tracks having those values.</span>
    <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">numerical_value_lookup</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_tracks</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">,</span>
                <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_bpm</span><span class="p">()),</span> <span class="n">track</span><span class="o">.</span><span class="n">get_rating</span><span class="p">(),</span> <span class="n">track</span><span class="o">.</span><span class="n">get_year</span><span class="p">()],</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">value</span>
                <span class="p">):</span>
                    <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>

    <span class="c1"># Add keys for string selectors for tracks having those values.</span>
    <span class="k">for</span> <span class="n">selector</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">string_value_lookup</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_tracks</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">selector_type</span><span class="p">,</span> <span class="n">selector_value</span> <span class="o">=</span> <span class="n">selector</span>
        <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">string_selector_type_map</span><span class="p">[</span><span class="n">selector_type</span><span class="p">])()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">selector_type</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
                <span class="n">inequality</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="o">=</span> <span class="n">selector_value</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inequality</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span> <span class="o">==</span> <span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span>
                        <span class="n">date_format</span>
                    <span class="p">):</span>
                        <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>
                    <span class="k">continue</span>
                <span class="c1"># In order for inequalities with lower precision levels than</span>
                <span class="c1"># YYYY-MM-DD to work properly, the date added value for the</span>
                <span class="c1"># track must be converted to the lower precision string and</span>
                <span class="c1"># back into a datetime object.</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                    <span class="n">value</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">date_format</span><span class="p">),</span> <span class="n">date_format</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">inequality</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="s2">&quot;*&quot;</span> <span class="ow">in</span> <span class="n">selector_value</span><span class="p">:</span>
                <span class="n">exp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selector_value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()):</span>
                    <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>
                    <span class="k">continue</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">selector_value</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="n">tags_tracks</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="n">track_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">track</span>

    <span class="c1"># Get playlists for the identified playlist selectors. Not only must we get</span>
    <span class="c1"># playlists from the collection, but we must also get playlists from the</span>
    <span class="c1"># auto playlists constructed in the very same run of the playlist_builder.</span>
    <span class="c1"># This is because the playlists being selected may include those generated</span>
    <span class="c1"># by the playlist_builder.</span>
    <span class="k">for</span> <span class="n">playlist_name</span> <span class="ow">in</span> <span class="n">playlists</span><span class="p">:</span>
        <span class="n">playlist_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="s2">playlist:</span><span class="si">{</span><span class="n">playlist_name</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">playlist_key</span> <span class="ow">in</span> <span class="n">tags_tracks</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">for</span> <span class="n">playlist_object</span> <span class="ow">in</span> <span class="p">[</span><span class="n">collection</span><span class="p">,</span> <span class="o">*</span><span class="n">auto_playlists</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlist_object</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">(</span><span class="n">playlist_name</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">playlist</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
                    <span class="k">continue</span>
                <span class="n">tags_tracks</span><span class="p">[</span><span class="n">playlist_key</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.aggregate_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregate_playlists</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Recursively aggregate tracks from folders into "All" playlists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist which may be a folder or not.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_class</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist implementation class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minimum_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required number of tracks to make a playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tracks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">aggregate_playlists</span><span class="p">(</span>
    <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">,</span>
    <span class="n">playlist_class</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">,</span>
    <span class="n">minimum_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively aggregate tracks from folders into &quot;All&quot; playlists.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist which may be a folder or not.</span>
<span class="sd">        playlist_class: Playlist implementation class.</span>
<span class="sd">        minimum_tracks: Required number of tracks to make a playlist.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict of tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get tracks from the playlist if it&#39;s not a folder.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span> <span class="k">if</span> <span class="n">playlist</span><span class="o">.</span><span class="n">aggregate</span><span class="p">()</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="c1"># Recursively get tracks from each playlist within this folder.</span>
    <span class="n">aggregate_tracks</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">playlist</span>
        <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">aggregate_playlists</span><span class="p">(</span>
            <span class="n">p</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_tracks</span>
        <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="n">playlist_too_small</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">minimum_tracks</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">aggregate_tracks</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minimum_tracks</span>
    <span class="p">)</span>

    <span class="c1"># Create an &quot;All&quot; playlist in this folder if the folder contains more than</span>
    <span class="c1"># one playlist.</span>
    <span class="k">if</span> <span class="n">playlist</span><span class="o">.</span><span class="n">aggregate</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">playlist_too_small</span><span class="p">:</span>
        <span class="n">playlist</span><span class="o">.</span><span class="n">add_playlist</span><span class="p">(</span>
            <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;All </span><span class="si">{</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">aggregate_tracks</span>
            <span class="p">),</span>
            <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">aggregate_tracks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.build_combiner_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_combiner_playlists</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">minimum_tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Recursively traverses a playlist config to generate playlists from tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="PlaylistConfig (djtools.collection.config.PlaylistConfig)" href="#djtools.collection.config.PlaylistConfig">PlaylistConfig</a>, <a class="autorefs autorefs-internal" title="PlaylistName (djtools.collection.config.PlaylistName)" href="#djtools.collection.config.PlaylistName">PlaylistName</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A component of a playlist config to create a playlist for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tags to tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_class</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist implementation class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minimum_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required number of tracks to make a playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's playlist config must not be malformed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="djtools.collection.base_playlist.Playlist">Playlist</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Playlist or None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_combiner_playlists</span><span class="p">(</span>
    <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PlaylistConfig</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]],</span>
    <span class="n">playlist_class</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">,</span>
    <span class="n">minimum_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Playlist</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively traverses a playlist config to generate playlists from tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        content: A component of a playlist config to create a playlist for.</span>
<span class="sd">        tags_tracks: Dict of tags to tracks.</span>
<span class="sd">        playlist_class: Playlist implementation class.</span>
<span class="sd">        minimum_tracks: Required number of tracks to make a playlist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The user&#39;s playlist config must not be malformed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Playlist or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="p">(</span><span class="n">PlaylistConfigContent</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid input type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Folders can opt-in to having an aggregation playlist.</span>
    <span class="n">enable_aggregation</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">):</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">tag_content</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">tag_content</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">name</span> <span class="o">=</span> <span class="n">content</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistConfigContent</span><span class="p">):</span>
        <span class="n">enable_aggregation</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">enable_aggregation</span>

    <span class="c1"># This is not a folder so a playlist with tracks must be created.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="p">(</span><span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tracks</span> <span class="o">=</span> <span class="n">parse_expression</span><span class="p">(</span><span class="n">tag_content</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing expression: </span><span class="si">{</span><span class="n">tag_content</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">minimum_tracks</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minimum_tracks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks</span><span class="p">,</span> <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span>
        <span class="p">)</span>

    <span class="c1"># This is a folder so create playlists for those playlists within it.</span>
    <span class="n">playlists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">playlists</span><span class="p">:</span>
        <span class="n">playlist</span> <span class="o">=</span> <span class="n">build_combiner_playlists</span><span class="p">(</span>
            <span class="n">item</span><span class="p">,</span>
            <span class="n">tags_tracks</span><span class="p">,</span>
            <span class="n">playlist_class</span><span class="p">,</span>
            <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tracks</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">playlist</span><span class="p">:</span>
            <span class="n">playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">playlist</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There are no tracks for the Combiner playlist: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">playlists</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;There were no playlists created from &quot;</span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">playlists</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">content</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">playlists</span><span class="o">=</span><span class="n">playlists</span><span class="p">,</span>
        <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.build_tag_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_tag_playlists</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">,</span> <span class="n">playlist_class</span><span class="p">,</span> <span class="n">tag_set</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimum_tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Recursively traverses a playlist config to generate playlists from tags.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>content</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="PlaylistConfigContent (djtools.collection.config.PlaylistConfigContent)" href="#djtools.collection.config.PlaylistConfigContent">PlaylistConfigContent</a>, <a class="autorefs autorefs-internal" title="PlaylistName (djtools.collection.config.PlaylistName)" href="#djtools.collection.config.PlaylistName">PlaylistName</a>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A component of a playlist config to create a playlist for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tags to tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_class</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist implementation class.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag_set</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Set">Set</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A set of tags seen while creating playlists. This is used to
indicate which tags should be ignored when creating the
"Unused Tags" playlists.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>minimum_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required number of tracks to make a playlist.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's playlist config must not be malformed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="djtools.collection.base_playlist.Playlist">Playlist</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Playlist or None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_tag_playlists</span><span class="p">(</span>
    <span class="n">content</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">PlaylistConfigContent</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]],</span>
    <span class="n">playlist_class</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">,</span>
    <span class="n">tag_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">minimum_tracks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Playlist</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively traverses a playlist config to generate playlists from tags.</span>

<span class="sd">    Args:</span>
<span class="sd">        content: A component of a playlist config to create a playlist for.</span>
<span class="sd">        tags_tracks: Dict of tags to tracks.</span>
<span class="sd">        playlist_class: Playlist implementation class.</span>
<span class="sd">        tag_set: A set of tags seen while creating playlists. This is used to</span>
<span class="sd">            indicate which tags should be ignored when creating the</span>
<span class="sd">            &quot;Unused Tags&quot; playlists.</span>
<span class="sd">        minimum_tracks: Required number of tracks to make a playlist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: The user&#39;s playlist config must not be malformed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Playlist or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="p">(</span><span class="n">PlaylistConfigContent</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid input type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize the set of tags in case the caller didn&#39;t provide one.</span>
    <span class="n">tag_set</span> <span class="o">=</span> <span class="n">tag_set</span> <span class="k">if</span> <span class="n">tag_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Folders can opt-in to having an aggregation playlist.</span>
    <span class="n">enable_aggregation</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistConfigContent</span><span class="p">):</span>
        <span class="n">enable_aggregation</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">enable_aggregation</span>

    <span class="c1"># This is a folder so create playlists for those playlists within it.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistConfigContent</span><span class="p">):</span>
        <span class="c1"># Update the set of tags seen so these are ignored in when creating the</span>
        <span class="c1"># &quot;Unused Tags&quot; playlists.</span>
        <span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;_ignore&quot;</span><span class="p">:</span>
            <span class="n">tag_set</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">playlists</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Create playlists for each playlist in this folder.</span>
        <span class="n">playlists</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">build_tag_playlists</span><span class="p">(</span>
                <span class="n">item</span><span class="p">,</span>
                <span class="n">tags_tracks</span><span class="p">,</span>
                <span class="n">playlist_class</span><span class="p">,</span>
                <span class="n">tag_set</span><span class="p">,</span>
                <span class="n">minimum_tracks</span><span class="o">=</span><span class="n">minimum_tracks</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">playlists</span>
        <span class="p">]</span>
        <span class="n">playlists</span> <span class="o">=</span> <span class="p">[</span><span class="n">playlist</span> <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlists</span> <span class="k">if</span> <span class="n">playlist</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlists</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;There were no playlists created from &quot;</span><span class="si">{</span><span class="n">content</span><span class="o">.</span><span class="n">playlists</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">content</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">playlists</span><span class="o">=</span><span class="n">playlists</span><span class="p">,</span>
            <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># This is not a folder so a playlist with tracks must be created.</span>

    <span class="c1"># If a PlaylistName is used, then the tag_content field is used to</span>
    <span class="c1"># determine the tag corresponding with this playlist and the name field is</span>
    <span class="c1"># used to name the playlist. Otherwise, the content is a string that</span>
    <span class="c1"># represents both the tag and the name.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">PlaylistName</span><span class="p">):</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">tag_content</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="n">tag_content</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tag_content</span> <span class="o">=</span> <span class="n">name</span> <span class="o">=</span> <span class="n">content</span>

    <span class="c1"># Apply special logic for creating a &quot;pure&quot; playlist. &quot;Pure&quot; playlists are</span>
    <span class="c1"># those that contain tracks with a set of genre tags that all contain the</span>
    <span class="c1"># sub-string indicated by the suffix of the playlist name. For example,</span>
    <span class="c1"># &quot;Pure Techno&quot; will contain tracks that have genres {&quot;Hard Techno&quot;,</span>
    <span class="c1"># &quot;Melodic Techno&quot;} but will not contain tracks that contain</span>
    <span class="c1"># {&quot;Hard Techno&quot;, &quot;Tech House&quot;} because &quot;Tech House&quot; does not contain</span>
    <span class="c1"># &quot;Techno&quot; as a sub-string.</span>
    <span class="k">if</span> <span class="n">tag_content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Pure &quot;</span><span class="p">):</span>
        <span class="c1"># Isolate the tag to create a pure playlist for.</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">tag_content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;Pure &quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tracks_with_tag</span> <span class="o">=</span> <span class="n">tags_tracks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tracks_with_tag</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Can</span><span class="se">\&#39;</span><span class="s1">t make a &quot;Pure </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s1">&quot; playlist because there are no &#39;</span>
                <span class="s2">&quot;tracks with that tag.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Filter out tracks that aren&#39;t pure.</span>
        <span class="n">pure_tag_tracks</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
            <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks_with_tag</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">_</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">())</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pure_tag_tracks</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Can</span><span class="se">\&#39;</span><span class="s1">t make a &quot;Pure </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s1">&quot; playlist because there are no &#39;</span>
                <span class="sa">f</span><span class="s2">&quot;tracks that are pure </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">minimum_tracks</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pure_tag_tracks</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minimum_tracks</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">tracks</span><span class="o">=</span><span class="n">pure_tag_tracks</span><span class="p">,</span>
            <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Get tracks with this tag and index it so that it&#39;s not added to the</span>
    <span class="c1"># &quot;Unused Tags&quot; playlists.</span>
    <span class="n">tracks_with_tag</span> <span class="o">=</span> <span class="n">tags_tracks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag_content</span><span class="p">)</span>
    <span class="n">tag_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tag_content</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tracks_with_tag</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are no tracks with the tag &quot;</span><span class="si">{</span><span class="n">tag_content</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">minimum_tracks</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">tracks_with_tag</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">minimum_tracks</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">playlist_class</span><span class="o">.</span><span class="n">new_playlist</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">tracks</span><span class="o">=</span><span class="n">tracks_with_tag</span><span class="p">,</span>
        <span class="n">enable_aggregation</span><span class="o">=</span><span class="n">enable_aggregation</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.copy_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy_file</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">destination</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Copies a track to a destination and updates its location.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>track</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_track.Track">Track</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Track object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>destination</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory to copy tracks to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@make_path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">copy_file</span><span class="p">(</span><span class="n">track</span><span class="p">:</span> <span class="n">Track</span><span class="p">,</span> <span class="n">destination</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copies a track to a destination and updates its location.</span>

<span class="sd">    Args:</span>
<span class="sd">        track: Track object.</span>
<span class="sd">        destination: Directory to copy tracks to.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">get_location</span><span class="p">()</span>
    <span class="n">dest</span> <span class="o">=</span> <span class="n">destination</span> <span class="o">/</span> <span class="n">loc</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">dest</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">loc</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span> <span class="n">dest</span><span class="p">)</span>
    <span class="n">track</span><span class="o">.</span><span class="n">set_location</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.filter_tag_playlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">playlist</span><span class="p">,</span> <span class="n">playlist_filters</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Applies a list of PlaylistFilter implementations to the playlist.</p>
<p>If the PlaylistFilter implementations' is_filter_playlist method evaluates
to True, then the filter_track method is applied to each track in the
playlist. The playlist's tracks are set to remove the tracks that have been
filtered out.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>playlist</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist to potentially have its tracks filtered.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlist_filters</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<a class="autorefs autorefs-internal" title="djtools.collection.playlist_filters.PlaylistFilter" href="../../developer_docs/playlist_filters/#djtools.collection.playlist_filters.PlaylistFilter">PlaylistFilter</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of PlaylistFilter implementations used to
filter playlist tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">filter_tag_playlists</span><span class="p">(</span>
    <span class="n">playlist</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">,</span> <span class="n">playlist_filters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">PlaylistFilter</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Applies a list of PlaylistFilter implementations to the playlist.</span>

<span class="sd">    If the PlaylistFilter implementations&#39; is_filter_playlist method evaluates</span>
<span class="sd">    to True, then the filter_track method is applied to each track in the</span>
<span class="sd">    playlist. The playlist&#39;s tracks are set to remove the tracks that have been</span>
<span class="sd">    filtered out.</span>

<span class="sd">    Args:</span>
<span class="sd">        playlist: Playlist to potentially have its tracks filtered.</span>
<span class="sd">        playlist_filters: A list of PlaylistFilter implementations used to</span>
<span class="sd">            filter playlist tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># This is a folder so filter its playlists.</span>
    <span class="k">if</span> <span class="n">playlist</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">_playlist</span> <span class="ow">in</span> <span class="n">playlist</span><span class="p">:</span>
            <span class="n">filter_tag_playlists</span><span class="p">(</span><span class="n">_playlist</span><span class="p">,</span> <span class="n">playlist_filters</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Apply each PlaylistFilter to this playlist.</span>
    <span class="k">for</span> <span class="n">playlist_filter</span> <span class="ow">in</span> <span class="n">playlist_filters</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">playlist_filter</span><span class="o">.</span><span class="n">is_filter_playlist</span><span class="p">(</span><span class="n">playlist</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="n">playlist</span><span class="o">.</span><span class="n">set_tracks</span><span class="p">(</span>
            <span class="n">tracks</span><span class="o">=</span><span class="p">{</span>
                <span class="n">track_id</span><span class="p">:</span> <span class="n">track</span>
                <span class="k">for</span> <span class="n">track_id</span><span class="p">,</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">playlist_filter</span><span class="o">.</span><span class="n">filter_track</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>
            <span class="p">},</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.parse_expression" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_expression</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses a boolean algebra expression by constructing a tree.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>expression</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String representing boolean algebra expression.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tags_tracks</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of tags to tracks.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="djtools.collection.base_track.Track">Track</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of track IDs and tracks.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_expression</span><span class="p">(</span>
    <span class="n">expression</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tags_tracks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Track</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a boolean algebra expression by constructing a tree.</span>

<span class="sd">    Args:</span>
<span class="sd">        expression: String representing boolean algebra expression.</span>
<span class="sd">        tags_tracks: Dict of tags to tracks.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict of track IDs and tracks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">BooleanNode</span><span class="p">(</span><span class="n">tags_tracks</span><span class="p">)</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">expression</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;(&quot;</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">BooleanNode</span><span class="p">(</span><span class="n">tags_tracks</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">is_operator</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_operand</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">node</span><span class="o">.</span><span class="n">add_operator</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">char</span> <span class="o">==</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_operand</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">tracks</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_parent</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">tracks</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">add_operand</span><span class="p">(</span><span class="n">tracks</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tag</span> <span class="o">+=</span> <span class="n">char</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_operand</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.parse_numerical_selectors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_numerical_selectors</span><span class="p">(</span><span class="n">numerical_matches</span><span class="p">,</span> <span class="n">numerical_value_lookup</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses a string match of one or more numerical selectors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>numerical_matches</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of numerical strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>numerical_value_lookup</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Tuple">Tuple</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Empty dict to populate with tuples or strings
mapping numerical ranges or values to their "tag" representation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Set">Set</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set of numerical selector values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_numerical_selectors</span><span class="p">(</span>
    <span class="n">numerical_matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">numerical_value_lookup</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a string match of one or more numerical selectors.</span>

<span class="sd">    Args:</span>
<span class="sd">        numerical_matches: List of numerical strings.</span>
<span class="sd">        numerical_value_lookup: Empty dict to populate with tuples or strings</span>
<span class="sd">            mapping numerical ranges or values to their &quot;tag&quot; representation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Set of numerical selector values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numerical_values</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">numerical_matches</span><span class="p">:</span>
        <span class="n">_range</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># If &quot;match&quot; is a digit, then it&#39;s an explicit numerical value.</span>
        <span class="k">if</span> <span class="n">match</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">numerical_values</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
        <span class="c1"># If &quot;match&quot; is two digits separated by a &quot;-&quot;, then it&#39;s a range.</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">_range</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)))</span>
            <span class="n">_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">_range</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">_range</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                <span class="nb">all</span><span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_range</span><span class="p">)</span>
                <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span><span class="mi">6</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">999</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_range</span><span class="p">)</span>  <span class="c1"># range for ratings</span>
                <span class="ow">or</span> <span class="nb">all</span><span class="p">(</span>  <span class="c1"># range for BPMs</span>
                    <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1000</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">_range</span>
                <span class="p">)</span>  <span class="c1"># range for years</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bad numerical range selector: </span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">numerical_values</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">_range</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Malformed numerical selector: </span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">numerical_value_lookup</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">_range</span> <span class="ow">or</span> <span class="p">[]))</span> <span class="ow">or</span> <span class="n">match</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">numerical_values</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.parse_string_selectors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_string_selectors</span><span class="p">(</span><span class="n">string_matches</span><span class="p">,</span> <span class="n">string_value_lookup</span><span class="p">,</span> <span class="n">string_selector_type_map</span><span class="p">,</span> <span class="n">playlists</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parses a string match of one or more string selectors.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>string_matches</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of strings for string selectors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>string_value_lookup</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Tuple">Tuple</span>], <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Empty dict to populate with strings mapping string
selectors to their "tag" representation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>string_selector_type_map</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maps a selector type to a Track method name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>playlists</code>
            </td>
            <td>
                  <code><span title="typing.Set">Set</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set for storing playlist names.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_string_selectors</span><span class="p">(</span>
    <span class="n">string_matches</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">string_value_lookup</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">string_selector_type_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">playlists</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parses a string match of one or more string selectors.</span>

<span class="sd">    Args:</span>
<span class="sd">        string_matches: List of strings for string selectors.</span>
<span class="sd">        string_value_lookup: Empty dict to populate with strings mapping string</span>
<span class="sd">            selectors to their &quot;tag&quot; representation.</span>
<span class="sd">        string_selector_type_map: Maps a selector type to a Track method name.</span>
<span class="sd">        playlists: Set for storing playlist names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">date_formats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;%Y-%m&quot;</span><span class="p">,</span> <span class="s2">&quot;%Y&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">string_matches</span><span class="p">:</span>
        <span class="n">selector_type</span><span class="p">,</span> <span class="n">selector_value</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">selector_type</span> <span class="o">==</span> <span class="s2">&quot;playlist&quot;</span><span class="p">:</span>
            <span class="n">playlists</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">selector_value</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">string_selector_type_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">selector_type</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">selector_type</span><span class="si">}</span><span class="s2"> is not a supported selector!&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">selector_type</span> <span class="o">!=</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
            <span class="n">string_value_lookup</span><span class="p">[(</span><span class="n">selector_type</span><span class="p">,</span> <span class="n">selector_value</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">dates</span><span class="p">,</span> <span class="n">formats</span><span class="p">,</span> <span class="n">inequalities</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">skip_date_selector</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">DATE_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">selector_value</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">date</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">date_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>

            <span class="c1"># Note if the part is an inequality and move onto the next part.</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">DATE_SELECTOR_REGEX</span><span class="p">,</span> <span class="n">part</span><span class="p">):</span>
                <span class="n">inequalities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">INEQUALITY_MAP</span><span class="p">[</span><span class="n">part</span><span class="p">])</span>
                <span class="k">continue</span>

            <span class="c1"># The following part may be a timedelta string...</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">parse_timedelta</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>

            <span class="c1"># ...but if it wasn&#39;t, it&#39;s probably an ISO format date string.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">date</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">date_format</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">break</span>

            <span class="c1"># If there&#39;s no date, then the selector wasn&#39;t formatted correctly.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">date</span><span class="p">:</span>
                <span class="n">skip_date_selector</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

            <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
            <span class="n">formats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date_format</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">skip_date_selector</span>
            <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span>
            <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inequalities</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Date selector </span><span class="si">{</span><span class="n">selector_value</span><span class="si">}</span><span class="s2"> is invalid!&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">string_value_lookup</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="n">selector_type</span><span class="p">,</span>
                <span class="p">(</span>
                    <span class="kc">None</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">inequalities</span> <span class="k">else</span> <span class="n">inequalities</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">formats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="si">{</span><span class="n">match</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.parse_timedelta" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_timedelta</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse a timedelta from a string and return the relative offset from now.</p>


<details class="supported-units-of-time" open>
  <summary>Supported units of time</summary>
  <ul>
<li>years</li>
<li>months</li>
<li>weeks</li>
<li>days</li>
</ul>
</details>

<details class="some-example-strings" open>
  <summary>Some example strings</summary>
  <ul>
<li>1y</li>
<li>6m</li>
<li>3m2w</li>
<li>7d</li>
</ul>
</details>        <p>Modified from peter's answer at https://stackoverflow.com/a/51916936</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>time_str</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string identifying a duration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="datetime.datetime">datetime</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A datetime.datetime object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_timedelta</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a timedelta from a string and return the relative offset from now.</span>

<span class="sd">    Supported units of time:</span>
<span class="sd">      - years</span>
<span class="sd">      - months</span>
<span class="sd">      - weeks</span>
<span class="sd">      - days</span>

<span class="sd">    Some example strings:</span>
<span class="sd">      - 1y</span>
<span class="sd">      - 6m</span>
<span class="sd">      - 3m2w</span>
<span class="sd">      - 7d</span>

<span class="sd">    Modified from peter&#39;s answer at https://stackoverflow.com/a/51916936</span>

<span class="sd">    Args:</span>
<span class="sd">        time_str: A string identifying a duration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A datetime.datetime object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">TIMEDELTA_REGEX</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">parts</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">time_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">parts</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span>
    <span class="p">}</span>

    <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">time_delta</span> <span class="o">=</span> <span class="n">relativedelta</span><span class="p">(</span><span class="o">**</span><span class="n">time_params</span><span class="p">)</span>
    <span class="n">relative_time</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">time_delta</span>

    <span class="k">return</span> <span class="n">relative_time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.print_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prints an ASCII histogram of tag data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag names to tag counts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints an ASCII histogram of tag data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Tag names to tag counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
    <span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scale_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">row_width</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">width_pad</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">row</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scaled_data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">while</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">key_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">key_center</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">key_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">width_pad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">key_center</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;*&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">scaled_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">width_pad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">key_center</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">row_width</span><span class="p">:</span>
            <span class="n">row_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">row</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">row_width</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">width_pad</span><span class="si">}{</span><span class="n">key</span><span class="si">}{</span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">width_pad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.print_playlists_tag_statistics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_playlists_tag_statistics</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Prints tag statistics for Combiner playlists.</p>
<p>Statistics are split out by Combiner playlist and then by TagParser type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>combiner_playlists</code>
            </td>
            <td>
                  <code><span title="djtools.collection.base_playlist.Playlist">Playlist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Playlist object for Combiner playlists.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_playlists_tag_statistics</span><span class="p">(</span><span class="n">combiner_playlists</span><span class="p">:</span> <span class="n">Playlist</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prints tag statistics for Combiner playlists.</span>

<span class="sd">    Statistics are split out by Combiner playlist and then by TagParser type.</span>

<span class="sd">    Args:</span>
<span class="sd">        combiner_playlists: Playlist object for Combiner playlists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">playlists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">playlist_stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">combiner_playlists</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">playlist_stack</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">playlist_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">is_folder</span><span class="p">():</span>
            <span class="n">playlist_stack</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">get_playlists</span><span class="p">())</span>
            <span class="k">continue</span>
        <span class="n">playlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">playlist</span> <span class="ow">in</span> <span class="n">playlists</span><span class="p">:</span>
        <span class="n">tracks</span> <span class="o">=</span> <span class="n">playlist</span><span class="o">.</span><span class="n">get_tracks</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">playlist</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> tag statistics:&quot;</span><span class="p">)</span>
        <span class="n">playlist_tags</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">genre_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">other_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">track_all_tags</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span>
            <span class="n">track_genre_tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">get_genre_tags</span><span class="p">())</span>
            <span class="n">other_tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">track_all_tags</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">track_genre_tags</span><span class="p">))</span>
            <span class="n">genre_tags</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">track_genre_tags</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">track_all_tags</span><span class="p">:</span>
                <span class="n">playlist_tags</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">tag_subset</span><span class="p">,</span> <span class="n">tags</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;Genre&quot;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">genre_tags</span><span class="p">)),</span>
            <span class="p">(</span><span class="s2">&quot;Other&quot;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other_tags</span><span class="p">)),</span>
        <span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">tag</span><span class="p">:</span> <span class="n">playlist_tags</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">tag_subset</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
                <span class="n">print_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="djtools.collection.helpers.scale_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scale_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Scales range of data values with an upper bound.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag names to tag counts.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maximum</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound for re-scaled data.</p>
              </div>
            </td>
            <td>
                  <code>25</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Re-scaled dictionary of tag names and tag counts.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/djtools/collection/helpers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">scale_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">maximum</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scales range of data values with an upper bound.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Tag names to tag counts.</span>
<span class="sd">        maximum: Upper bound for re-scaled data.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Re-scaled dictionary of tag names and tag counts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">v</span> <span class="o">/</span> <span class="n">data_max</span><span class="p">)</span> <span class="o">*</span> <span class="n">maximum</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>